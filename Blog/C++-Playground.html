<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2021-05-31 Mon 18:28 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>C++ Playground</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Cycoe">
<link rel="stylesheet" type="text/css" href="/static/css/default.css" />
<link rel="shortcut icon" type="image/png" href="/static/img/favicon.png"/>
<script language="JavaScript" type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script language="JavaScript" type="text/javascript" src="/static/js/main.js"></script>
</head>
<body>
<div id="preamble" class="status">
<div id="top-container">
  <a id="site-name" href="/">Cycoe<span id="at-home">@Home</span></a>
  <div id="banner">Keep It Simple Stupid</div>
</div>

<div id="top-nav">
  <div id="nav-wrapper">
    <div class="nav-btn" id="toc-wrapper">
      <span class="vertical-align">Ξ</span>
      <div id="go-top">
        <a href="javascript:window.scrollTo(0,0)" style="color: black !important; border-bottom: none !important;" class="tooltip" title="Go to the top of the page">
        <span class="top">&uarr;</span>
        </a></div>
    </div>
    <div id="nav-left-wrapper">
      <a class="nav-btn" id="photo-entry" href="/Photo/index.html" title="Photo">Photo</a>
      <a class="nav-btn" id="about-entry" href="/about.html" title="About Me">About</a>
      <div id="nav-title-wrapper">
        <span id="nav-title">C++ Playground</span>
        <span id="nav-date">Written @<2020-06-10 Wed 10:34></span>
      </div>
    </div>
  </div>
</div>

<!-- The Modal -->
<div id="img-modal" class="modal">
  <!-- The Close Button -->
  <span class="close">&times;</span>
  <!-- Modal Content (The Image) -->
  <img class="modal-content" id="img-wrapper">
  <!-- Modal Caption (Image Text) -->
  <div id="caption"></div>
</div>
</div>
<div id="content">
<header>
<h1 class="title">C++ Playground</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org5e229a2">1. 返回局部变量的引用</a></li>
<li><a href="#org5de8adb">2. 引用传递</a></li>
<li><a href="#org75c229a">3. 泛型数组模板</a></li>
<li><a href="#orgd8edc12">4. 可变参数模板</a></li>
<li><a href="#orge249612">5. <span class="todo TODO">TODO</span> 几种初始化方法的区别</a></li>
<li><a href="#orgd183fe3">6. 实现 <code>for_each</code></a></li>
<li><a href="#org0800ebe">7. <code>std::vector</code> 内存分配策略</a></li>
<li><a href="#org89ba6df">8. <code>std::string</code> 的一些操作</a></li>
<li><a href="#org59d5f69">9. 泛型算法</a></li>
<li><a href="#org5bfd3e0">10. 迭代器的一些高级用法</a></li>
<li><a href="#org99ad279">11. 关联容器</a></li>
<li><a href="#org52f8a36">12. <code>std::format</code></a></li>
<li><a href="#org4093c64">13. <code>range</code> 与 <code>view</code> 视图</a></li>
<li><a href="#org505a6c3">14. 动态内存</a></li>
<li><a href="#orgc78d42f">15. <code>allocator</code></a></li>
<li><a href="#orgc8bde69">16. 单例模式</a></li>
<li><a href="#org527a59b">17. 容器的常量性</a></li>
<li><a href="#orgd2d4f61">18. 设计一个文本单词查询程序</a></li>
<li><a href="#orgaeebbce">19. 树的遍历</a></li>
<li><a href="#org71976a6">20. <code>std::pair</code> 与 <code>std::tuple</code></a>
<ul>
<li><a href="#orgc8fbd71">20.1. <code>std::pair</code></a></li>
<li><a href="#orge713317">20.2. <code>std::tuple</code></a></li>
</ul>
</li>
<li><a href="#org1a7c9bc">21. 智能指针与自定义 <code>deleter</code></a></li>
<li><a href="#org78aa69a">22. Type Trait</a></li>
<li><a href="#org564998c">23. 辅助函数</a>
<ul>
<li><a href="#orgff1e51f">23.1. <code>std::max</code></a></li>
<li><a href="#orgc8cba45">23.2. <code>std::swap</code></a></li>
<li><a href="#org721fce2">23.3. <code>ratio&lt;&gt;</code> 编译期分数运算</a></li>
<li><a href="#orga8f3753">23.4. <code>chrono</code></a>
<ul>
<li><a href="#org5ce6708">23.4.1. Duration 的算数运算</a></li>
<li><a href="#org4077aaf">23.4.2. Duration 的其它操作</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>

<div id="outline-container-org5e229a2" class="outline-2">
<h2 id="org5e229a2"><span class="section-number-2">1</span> 返回局部变量的引用</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> &amp;<span style="color: #c678dd;">foo</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span> = 0;
  <span style="color: #51afef;">return</span> i;    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">warning: reference to local variable &#8216;i&#8217; returned</span>
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">bar</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span> = 0;
  <span style="color: #51afef;">return</span> i;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36816;&#34892;&#20986;&#29616; =segmentation fault (core dumped)=</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22312; foo &#36820;&#22238;&#26102;&#23616;&#37096;&#21464;&#37327; i &#23601;&#20250;&#34987;&#37322;&#25918;&#65292;&#22240;&#27492;&#36820;&#22238;&#30340;&#24341;&#29992;&#26159;&#25351;&#21521;&#24050;&#37322;&#25918;&#20869;&#23384;</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span> = foo<span style="color: #c678dd;">()</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20989;&#25968; bar &#36820;&#22238;&#20102;&#19968;&#20010;&#20026;&#21491;&#20540;&#30340; int &#22411;&#20020;&#26102;&#21464;&#37327;&#65292;&#22240;&#27492;&#21482;&#33021;&#20351;&#29992;&#24120;&#37327;&#24341;&#29992;</span>
  <span style="color: #ECBE7B;">int</span> &amp;<span style="color: #dcaeea;">ir</span> = bar<span style="color: #c678dd;">()</span>;         <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#38169;&#35823;</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">icr</span> = bar<span style="color: #c678dd;">()</span>;  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#27491;&#30830;</span>
<span style="color: #51afef;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5de8adb" class="outline-2">
<h2 id="org5de8adb"><span class="section-number-2">2</span> 引用传递</h2>
<div class="outline-text-2" id="text-2">
<p>
这样看来，引用与变量在作为右值时是没有区别的
</p>
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span> = 10;
  <span style="color: #ECBE7B;">int</span> &amp;<span style="color: #dcaeea;">ir</span> = i;
  <span style="color: #ECBE7B;">int</span> &amp;<span style="color: #dcaeea;">irr</span> = ir;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; irr &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  i = 20;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; ir &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; irr &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">20</td>
</tr>
</tbody>
</table>

<p>
这也就解释了在重载 <code>&lt;&lt;</code> 运算符时传入 <code>ostream</code> 对象的引用再传出是可行的
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">typedef</span> <span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">Coor</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">float</span> <span style="color: #dcaeea;">x</span>;
  <span style="color: #ECBE7B;">float</span> <span style="color: #dcaeea;">y</span>;
  <span style="color: #ECBE7B;">float</span> <span style="color: #dcaeea;">z</span>;
<span style="color: #51afef;">}</span> <span style="color: #ECBE7B;">Coor</span>;

<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span> &amp;<span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span><span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span> &amp;<span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">Coor</span> &amp;<span style="color: #dcaeea;">coor</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"("</span> &lt;&lt; coor.x &lt;&lt; <span style="color: #98be65;">", "</span> &lt;&lt; coor.y &lt;&lt; <span style="color: #98be65;">", "</span> &lt;&lt; coor.z &lt;&lt; <span style="color: #98be65;">")"</span>;
  <span style="color: #51afef;">return</span> os;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">Coor</span> <span style="color: #dcaeea;">coor</span> = <span style="color: #c678dd;">{</span>0.0, 1.0, 2.0<span style="color: #c678dd;">}</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; coor &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">(0</td>
<td class="org-right">1</td>
<td class="org-right">2)</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> &amp;<span style="color: #c678dd;">foo</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">int</span> &amp;<span style="color: #dcaeea;">i</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> ++i;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span> = 10;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">foo &#36820;&#22238;&#20102; i &#30340;&#24341;&#29992;&#65292;&#24182;&#23558; i &#30340;&#20540;&#36171;&#20540;&#32473; j</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">i &#19982; j &#26159;&#20004;&#20010;&#19981;&#21516;&#30340;&#21464;&#37327;</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">j</span> = foo<span style="color: #c678dd;">(</span>i<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"i is "</span> &lt;&lt; i &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"j is "</span> &lt;&lt; j &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">i</td>
<td class="org-left">is</td>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-left">j</td>
<td class="org-left">is</td>
<td class="org-right">11</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org75c229a" class="outline-2">
<h2 id="org75c229a"><span class="section-number-2">3</span> 泛型数组模板</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">cassert</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">cstddef</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">Array</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558; &lt;&lt; &#36816;&#31639;&#31526;&#30340;&#37325;&#36733;&#20989;&#25968;&#22768;&#26126;&#20026;&#21451;&#20803;&#65292;&#27492;&#22788;&#27880;&#24847;&#19968;&#23450;&#35201;&#22768;&#26126;&#20026;&#27169;&#26495;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21542;&#21017;&#32534;&#35793;&#26102;&#20250;&#25552;&#31034;&#37325;&#36733;&#20989;&#25968;&#19981;&#26159;&#19968;&#20010;&#20989;&#25968;&#27169;&#26495;</span>
  <span style="color: #51afef;">template</span><span style="color: #c678dd;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Ty</span><span style="color: #c678dd;">&gt;</span>
  <span style="color: #51afef;">friend</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span> &amp;<span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span> &amp;<span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">Array</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">Ty</span><span style="color: #98be65;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span>;

<span style="color: #51afef;">public</span>:
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26500;&#36896;&#19982;&#26512;&#26500;</span>
  Array<span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">size</span><span style="color: #c678dd;">)</span>;           <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#24050;&#30693;&#38271;&#24230;</span>
  Array<span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #98be65;">&lt;</span>T<span style="color: #98be65;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span>;         <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20174;&#21478;&#19968; Array &#25335;&#36125;</span>
  Array<span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span> *<span style="color: #dcaeea;">rhs</span>, <span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">size</span><span style="color: #c678dd;">)</span>;   <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20174;&#25968;&#32452;&#26500;&#36896;</span>
  Array<span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span> *<span style="color: #dcaeea;">beg</span>, <span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span> *<span style="color: #dcaeea;">end</span><span style="color: #c678dd;">)</span>;  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20256;&#20837;&#25968;&#32452;&#30340;&#22836;&#23614;&#25351;&#38024;</span>
  ~<span style="color: #c678dd;">Array</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span> <span style="color: #51afef;">delete</span><span style="color: #98be65;">[]</span> arr; <span style="color: #c678dd;">}</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25509;&#21475;</span>
  <span style="color: #ECBE7B;">size_t</span> <span style="color: #c678dd;">size</span><span style="color: #c678dd;">()</span> <span style="color: #51afef;">const</span>;
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> &amp;<span style="color: #c678dd;">extend</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #98be65;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36816;&#31639;&#31526;&#37325;&#36733;</span>
  <span style="color: #ECBE7B;">T</span> &amp;<span style="color: #51afef;">operator</span><span style="color: #c678dd;">[]</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">index</span><span style="color: #c678dd;">)</span>;             <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#19979;&#26631;&#36816;&#31639;&#31526;</span>
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> &amp;<span style="color: #51afef;">operator</span><span style="color: #c678dd;">=</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #98be65;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span>;      <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36171;&#20540;&#36816;&#31639;&#31526;</span>
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">+</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #98be65;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span> <span style="color: #51afef;">const</span>; <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20004; Array &#30456;&#21152;</span>
  <span style="color: #ECBE7B;">bool</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">==</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #98be65;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span> <span style="color: #51afef;">const</span>;    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21028;&#26029;&#30456;&#31561;</span>

<span style="color: #51afef;">private</span>:
  <span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">sz</span> = 0;
  <span style="color: #ECBE7B;">T</span> *<span style="color: #dcaeea;">arr</span> = <span style="color: #a9a1e1;">nullptr</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #c678dd;">Array</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">size</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  sz = size;
  arr = <span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">[</span>sz<span style="color: #c678dd;">]</span>;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #c678dd;">Array</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  sz = rhs.sz;
  arr = <span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">[</span>sz<span style="color: #c678dd;">]</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = 0; i &lt; sz; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> = rhs.arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #c678dd;">Array</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span> *<span style="color: #dcaeea;">rhs</span>, <span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">size</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  sz = size;
  arr = <span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">[</span>sz<span style="color: #c678dd;">]</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = 0; i &lt; sz; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> = rhs<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #c678dd;">Array</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span> *<span style="color: #dcaeea;">beg</span>, <span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span> *<span style="color: #dcaeea;">end</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  sz = end - beg;
  arr = <span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">[</span>sz<span style="color: #c678dd;">]</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = 0; i &lt; sz; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> = beg<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">inline</span> <span style="color: #ECBE7B;">size_t</span> <span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #c678dd;">size</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">const</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> sz;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">inline</span> <span style="color: #ECBE7B;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span> &amp;<span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #c678dd;">extend</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">new_size</span> = sz + rhs.sz;
  <span style="color: #ECBE7B;">T</span> *<span style="color: #dcaeea;">new_arr</span> = <span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">[</span>new_size<span style="color: #c678dd;">]</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = 0; i &lt; sz; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    new_arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> = arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = sz; i &lt; new_size; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    new_arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> = rhs.arr<span style="color: #98be65;">[</span>i - sz<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">delete</span><span style="color: #c678dd;">[]</span> arr;
  arr = new_arr;
  sz = new_size;
  <span style="color: #51afef;">return</span> *<span style="color: #51afef;">this</span>;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">T</span> &amp;<span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #51afef;">operator</span><span style="color: #51afef;">[]</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">index</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  assert<span style="color: #c678dd;">(</span>index &gt;= 0 &amp;&amp; index &lt; sz<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> arr<span style="color: #c678dd;">[</span>index<span style="color: #c678dd;">]</span>;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span> &amp;<span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span><span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span> &amp;<span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = 0; i &lt; rhs.sz; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; rhs.arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> &lt;&lt; <span style="color: #98be65;">", "</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">return</span> os;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span> &amp;<span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #51afef;">operator</span><span style="color: #c678dd;">=</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  assert<span style="color: #c678dd;">(</span>sz == rhs.sz<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = 0; i &lt; sz; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> = rhs.arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span> <span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #51afef;">operator</span><span style="color: #c678dd;">+</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">const</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">size</span> = sz + rhs.sz;
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">tmp</span><span style="color: #c678dd;">(</span>size<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = 0; i &lt; sz; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    tmp.arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> = arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span> = sz; i &lt; size; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    tmp.arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> = rhs.arr<span style="color: #98be65;">[</span>i - sz<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">return</span> tmp;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">bool</span> <span style="color: #a9a1e1;">Array</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>::<span style="color: #51afef;">operator</span><span style="color: #c678dd;">==</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">const</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>sz != rhs.sz<span style="color: #c678dd;">)</span>
    <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">false</span>;
  <span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">i</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>i = 0; arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> == rhs.arr<span style="color: #98be65;">[</span>i<span style="color: #98be65;">]</span> &amp;&amp; i &lt; sz; ++i<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> i == sz;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::string<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">arrstr1</span><span style="color: #c678dd;">(</span>5<span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::string<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">arrstr2</span><span style="color: #c678dd;">(</span>5<span style="color: #c678dd;">)</span>;
  arrstr1<span style="color: #c678dd;">[</span>0<span style="color: #c678dd;">]</span> = <span style="color: #98be65;">"Hello"</span>;
  arrstr1<span style="color: #c678dd;">[</span>1<span style="color: #c678dd;">]</span> = <span style="color: #98be65;">"world"</span>;
  arrstr1<span style="color: #c678dd;">[</span>2<span style="color: #c678dd;">]</span> = <span style="color: #98be65;">"hello"</span>;
  arrstr1<span style="color: #c678dd;">[</span>3<span style="color: #c678dd;">]</span> = <span style="color: #98be65;">"C++"</span>;
  arrstr1<span style="color: #c678dd;">[</span>4<span style="color: #c678dd;">]</span> = <span style="color: #98be65;">"!"</span>;
  arrstr2 = arrstr1;    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36171;&#20540;&#25805;&#20316;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; arrstr2 &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">ints</span><span style="color: #c678dd;">[</span>5<span style="color: #c678dd;">]</span> = <span style="color: #c678dd;">{</span>1, 2, 3, 4, 5<span style="color: #c678dd;">}</span>;
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">arrint1</span><span style="color: #c678dd;">(</span>ints, 5<span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">arrint2</span><span style="color: #c678dd;">(</span>ints, ints + 3<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; arrint1 &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; arrint2 &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"arrint1 and arrint2 is "</span>
            &lt;&lt; <span style="color: #c678dd;">(</span><span style="color: #98be65;">(</span>arrint1 == arrint2<span style="color: #98be65;">)</span>? <span style="color: #98be65;">""</span>: <span style="color: #98be65;">"not "</span><span style="color: #c678dd;">)</span>    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21028;&#26029; arrint1 &#21644; arrint2 &#26159;&#21542;&#30456;&#31561;</span>
            &lt;&lt; <span style="color: #98be65;">"equal."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #ECBE7B;">Array</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">arrintsum</span> = arrint1 + arrint2;          <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20004;&#20154; Array &#30456;&#21152;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; arrintsum &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; arrint1.extend<span style="color: #c678dd;">(</span>arrint1<span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl; <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#29992; arrint1 &#25193;&#23637;&#33258;&#36523;</span>
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Hello,</td>
<td class="org-left">world,</td>
<td class="org-left">hello,</td>
<td class="org-left">C++,</td>
<td class="org-left">!,</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">1,</td>
<td class="org-left">2,</td>
<td class="org-left">3,</td>
<td class="org-left">4,</td>
<td class="org-left">5,</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">1,</td>
<td class="org-left">2,</td>
<td class="org-left">3,</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">arrint1</td>
<td class="org-left">and</td>
<td class="org-left">arrint2</td>
<td class="org-left">is</td>
<td class="org-left">not</td>
<td class="org-left">equal.</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">1,</td>
<td class="org-left">2,</td>
<td class="org-left">3,</td>
<td class="org-left">4,</td>
<td class="org-left">5,</td>
<td class="org-left">1,</td>
<td class="org-left">2,</td>
<td class="org-left">3,</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">1,</td>
<td class="org-left">2,</td>
<td class="org-left">3,</td>
<td class="org-left">4,</td>
<td class="org-left">5,</td>
<td class="org-left">1,</td>
<td class="org-left">2,</td>
<td class="org-left">3,</td>
<td class="org-left">4,</td>
<td class="org-left">5,</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgd8edc12" class="outline-2">
<h2 id="orgd8edc12"><span class="section-number-2">4</span> 可变参数模板</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span> <span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span>, <span style="color: #51afef;">typename</span><span style="color: #c678dd;">...</span> <span style="color: #ECBE7B;">Types</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #dcaeea;">firstArg</span>, <span style="color: #ECBE7B;">Types</span><span style="color: #c678dd;">...</span> <span style="color: #dcaeea;">args</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; firstArg &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  print<span style="color: #c678dd;">(</span>args<span style="color: #c678dd;">...</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">s</span><span style="color: #c678dd;">(</span><span style="color: #98be65;">"world"</span><span style="color: #c678dd;">)</span>;
  print<span style="color: #c678dd;">(</span>7.5, <span style="color: #98be65;">"hello"</span>, s<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">7.5</td>
</tr>

<tr>
<td class="org-left">hello</td>
</tr>

<tr>
<td class="org-left">world</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orge249612" class="outline-2">
<h2 id="orge249612"><span class="section-number-2">5</span> <span class="todo TODO">TODO</span> 几种初始化方法的区别</h2>
<div class="outline-text-2" id="text-5">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">C</span> <span style="color: #51afef;">{</span>
<span style="color: #51afef;">public</span>:
  <span style="color: #c678dd;">C</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">s</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">this</span>-&gt;s = s;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">private</span>:
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">s</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">C</span> <span style="color: #dcaeea;">c1</span> = <span style="color: #98be65;">"hello"</span>;    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25335;&#36125;&#26500;&#36896;&#65292;&#35843;&#29992; C(C const&amp;)&#65292;&#31561;&#21495;&#21518;&#38754;&#38656;&#35201;&#30340;&#26159;&#31867;&#22411; C</span>
  <span style="color: #ECBE7B;">C</span> <span style="color: #dcaeea;">c2</span><span style="color: #c678dd;">(</span><span style="color: #98be65;">"hello"</span><span style="color: #c678dd;">)</span>;     <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26681;&#25454;&#20256;&#20837;&#21442;&#25968;&#35843;&#29992;&#23545;&#24212;&#26500;&#36896;&#20989;&#25968;&#65292;&#27492;&#22788;&#35843;&#29992; C(std::string const &amp;)</span>
  <span style="color: #ECBE7B;">C</span> <span style="color: #dcaeea;">c3</span><span style="color: #c678dd;">{</span><span style="color: #98be65;">"hello"</span><span style="color: #c678dd;">}</span>;     <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20351;&#29992;&#21442;&#25968;&#21015;&#21021;&#22987;&#21270;&#65292;&#35843;&#29992; C(): s("hello")</span>
  <span style="color: #ECBE7B;">C</span> <span style="color: #dcaeea;">c4</span> = <span style="color: #c678dd;">{</span><span style="color: #98be65;">"hello"</span><span style="color: #c678dd;">}</span>;  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36824;&#27809;&#25630;&#26126;&#30333;</span>
<span style="color: #51afef;">}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd183fe3" class="outline-2">
<h2 id="orgd183fe3"><span class="section-number-2">6</span> 实现 <code>for_each</code></h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">type_traits</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">cmath</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23454;&#29616; Python &#20013;&#30340; map &#20989;&#25968;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">Container: &#23481;&#22120;&#31867;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">Callable: &#21487;&#35843;&#29992;&#23545;&#35937;&#65288;&#20989;&#25968;&#25110;&#20223;&#20989;&#25968;&#65289;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Container</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Callable</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">Container</span>&amp; <span style="color: #c678dd;">foreach</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Container</span>&amp; <span style="color: #dcaeea;">c</span>, <span style="color: #ECBE7B;">Callable</span> <span style="color: #dcaeea;">op</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">Container</span>::<span style="color: #ECBE7B;">iterator</span> <span style="color: #dcaeea;">pos</span>;
  <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">Container</span>::<span style="color: #ECBE7B;">iterator</span> <span style="color: #dcaeea;">end</span> = c.end<span style="color: #c678dd;">()</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>pos = c.begin<span style="color: #98be65;">()</span>; pos != end; ++pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    op<span style="color: #98be65;">(</span>*pos<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">return</span> c;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36825;&#31181;&#20889;&#27861;&#26080;&#27861;&#33258;&#21160;&#25512;&#26029;&#65292;&#21482;&#33021;&#25163;&#21160;&#25351;&#23450;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Container</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Callable</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">foreach</span><span style="color: #51afef;">(</span><span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">Container</span>::<span style="color: #ECBE7B;">iterator</span> <span style="color: #dcaeea;">pos</span>,
             <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">Container</span>::<span style="color: #ECBE7B;">iterator</span> <span style="color: #dcaeea;">end</span>, <span style="color: #ECBE7B;">Callable</span> <span style="color: #dcaeea;">op</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span>pos != end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    op<span style="color: #98be65;">(</span>*pos++<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Callable</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">foreach</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">pos</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">end</span>, <span style="color: #ECBE7B;">Callable</span> <span style="color: #dcaeea;">op</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span>pos != end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    op<span style="color: #98be65;">(</span>*pos++<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23454;&#29616; Python &#20013;&#30340; reduce &#20989;&#25968;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">Container: &#23481;&#22120;&#31867;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">Callable: &#21487;&#35843;&#29992;&#23545;&#35937;&#65288;&#20989;&#25968;&#25110;&#20223;&#20989;&#25968;&#65289;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36820;&#22238;&#20540;&#26159;&#20540;&#20256;&#36882;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Container</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Callable</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">auto</span> <span style="color: #c678dd;">reduce</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Container</span>&amp; <span style="color: #dcaeea;">c</span>, <span style="color: #ECBE7B;">Callable</span> <span style="color: #dcaeea;">op</span><span style="color: #51afef;">)</span> -&gt; <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">decay_t</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">decltype</span><span style="color: #c678dd;">(</span>c<span style="color: #98be65;">[</span>0<span style="color: #98be65;">]</span><span style="color: #c678dd;">)</span><span style="color: #51afef;">&gt;</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">ElemType</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">decay_t</span><span style="color: #c678dd;">&lt;</span><span style="color: #51afef;">decltype</span><span style="color: #98be65;">(</span>c<span style="color: #a9a1e1;">[</span>0<span style="color: #a9a1e1;">]</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">&gt;</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22914;&#26524;&#23481;&#22120;&#20026;&#31354;&#65292;&#36820;&#22238;&#19982;&#23481;&#22120;&#31532;&#19968;&#20010;&#20803;&#32032;&#31867;&#22411;&#30456;&#21516;&#30340;&#38646;&#21021;&#22987;&#21270;&#23545;&#35937;&#65292;&#27880;&#24847;&#27492;&#22788;&#38656;&#35201;&#36864;&#21270;</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>c.empty<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> ElemType<span style="color: #98be65;">{}</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23481;&#22120;&#38271;&#24230;&#20026; 1 &#26102;&#30452;&#25509;&#36820;&#22238;&#31532;&#19968;&#20010;&#20803;&#32032;</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>c.size<span style="color: #98be65;">()</span> == 1<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> c<span style="color: #98be65;">[</span>0<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #ECBE7B;">ElemType</span> <span style="color: #dcaeea;">ret</span><span style="color: #c678dd;">(</span>c<span style="color: #98be65;">[</span>0<span style="color: #98be65;">]</span><span style="color: #c678dd;">)</span>;
  foreach<span style="color: #c678dd;">(</span>c.begin<span style="color: #98be65;">()</span> + 1, c.end<span style="color: #98be65;">()</span>, <span style="color: #98be65;">[</span>&amp;<span style="color: #dcaeea;">ret</span>, &amp;<span style="color: #dcaeea;">op</span><span style="color: #98be65;">](</span><span style="color: #ECBE7B;">ElemType</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">elem</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
    ret = op<span style="color: #a9a1e1;">(</span>ret, elem<span style="color: #a9a1e1;">)</span>;
  <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> ret;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Callable</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">auto</span> <span style="color: #c678dd;">reduce</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">pos</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">end</span>, <span style="color: #ECBE7B;">Callable</span> <span style="color: #dcaeea;">op</span><span style="color: #51afef;">)</span> -&gt; <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">decay_t</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">decltype</span><span style="color: #c678dd;">(</span>*pos<span style="color: #c678dd;">)</span><span style="color: #51afef;">&gt;</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">ElemType</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">decay_t</span><span style="color: #c678dd;">&lt;</span><span style="color: #51afef;">decltype</span><span style="color: #98be65;">(</span>*pos<span style="color: #98be65;">)</span><span style="color: #c678dd;">&gt;</span>;

  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>pos == end <span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> ElemType<span style="color: #98be65;">{}</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>end - pos == 1<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> *pos;
  <span style="color: #c678dd;">}</span>

  <span style="color: #ECBE7B;">ElemType</span> <span style="color: #dcaeea;">ret</span><span style="color: #c678dd;">(</span>*pos<span style="color: #c678dd;">)</span>;
  foreach<span style="color: #c678dd;">(</span>pos + 1, end, <span style="color: #98be65;">[</span>&amp;<span style="color: #dcaeea;">ret</span>, &amp;<span style="color: #dcaeea;">op</span><span style="color: #98be65;">](</span><span style="color: #ECBE7B;">ElemType</span> <span style="color: #51afef;">const</span> &amp; <span style="color: #dcaeea;">elem</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
    ret = op<span style="color: #a9a1e1;">(</span>ret, elem<span style="color: #a9a1e1;">)</span>;
  <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> ret;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Container</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">ElemType</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">linspace</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Container</span>&amp; <span style="color: #dcaeea;">c</span>, <span style="color: #ECBE7B;">ElemType</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">start</span>,
              <span style="color: #ECBE7B;">ElemType</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">end</span>, <span style="color: #ECBE7B;">ElemType</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">sep</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span><span style="color: #51afef; font-weight: bold;">!</span><span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">is_same</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">decay_t</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #51afef;">decltype</span><span style="color: #4db5bd;">(</span>c<span style="color: #51afef;">[</span>0<span style="color: #51afef;">]</span><span style="color: #4db5bd;">)</span><span style="color: #a9a1e1;">&gt;</span>, <span style="color: #ECBE7B;">ElemType</span><span style="color: #98be65;">&gt;</span>::value<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cerr &lt;&lt; <span style="color: #98be65;">"Element in container should be same type with range!\n"</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">ElemType</span> <span style="color: #dcaeea;">current</span> = start; current &lt; end; current += sep<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    c.push_back<span style="color: #98be65;">(</span>current<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21021;&#22987;&#21270;&#19968;&#20010;&#31561;&#24046;&#25968;&#21015;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">dvec</span>;
  linspace<span style="color: #c678dd;">(</span>dvec, 1.0, 5.0, 0.001<span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#35745;&#31639;&#23545;&#24212;&#30340; log &#20989;&#25968;&#20540;&#65292;&#24182;&#20056;&#19978;&#27493;&#38271;</span>
  foreach<span style="color: #c678dd;">(</span>dvec.begin<span style="color: #98be65;">()</span>, dvec.end<span style="color: #98be65;">()</span>, <span style="color: #98be65;">[](</span><span style="color: #ECBE7B;">double</span>&amp; <span style="color: #dcaeea;">elem</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
    elem = log<span style="color: #a9a1e1;">(</span>elem<span style="color: #a9a1e1;">)</span> * 0.001;
  <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#27714; ln(x) &#22312; [1, 5] &#33539;&#22260;&#20869;&#30340;&#31215;&#20998;&#20540;</span>
  <span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">integral</span> = reduce<span style="color: #c678dd;">(</span>dvec.begin<span style="color: #98be65;">()</span>, dvec.end<span style="color: #98be65;">()</span>, <span style="color: #98be65;">[](</span><span style="color: #ECBE7B;">double</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #ECBE7B;">double</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">b</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
    <span style="color: #51afef;">return</span> a + b;
  <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Integral of ln(x) in [1, 5] is "</span> &lt;&lt; integral &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Integral of ln(x) in [1</td>
<td class="org-left">5] is 4.04638</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org0800ebe" class="outline-2">
<h2 id="org0800ebe"><span class="section-number-2">7</span> <code>std::vector</code> 内存分配策略</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22312;&#28155;&#21152;&#20803;&#32032;&#20043;&#21069;&#30340;&#23481;&#37327;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Capacity is "</span> &lt;&lt; ivec.capacity<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#28155;&#21152; 24 &#20010;&#20803;&#32032;</span>
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">vector</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #98be65;">&gt;</span>::<span style="color: #ECBE7B;">size_type</span> <span style="color: #dcaeea;">pos</span> = 0; pos &lt; 24; ++pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    ivec.push_back<span style="color: #98be65;">(</span>pos<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">ivec &#22312;&#19981;&#35302;&#21457;&#37325;&#26032;&#20869;&#23384;&#20998;&#37197;&#20043;&#21069;&#21487;&#20445;&#23384;&#22810;&#23569;&#20010;&#20803;&#32032;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Capacity is "</span> &lt;&lt; ivec.capacity<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#35774;&#23450;&#20445;&#30041; 24 &#20010;&#21487;&#29992;&#31354;&#38388;</span>
  ivec.reserve<span style="color: #c678dd;">(</span>24<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#24403;&#25351;&#23450;&#30340;&#20803;&#32032;&#20010;&#25968;&#23567;&#20110;&#23454;&#38469;&#30340;&#20010;&#25968;&#26102;&#65292;&#19981;&#20250;&#22238;&#25910;&#20869;&#23384;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Capacity is "</span> &lt;&lt; ivec.capacity<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25351;&#23450;&#20445;&#30041; 48 &#20010;&#21487;&#29992;&#31354;&#38388;</span>
  ivec.reserve<span style="color: #c678dd;">(</span>48<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#24403;&#25351;&#23450;&#30340;&#20803;&#32032;&#20010;&#25968;&#22823;&#20110;&#23454;&#38469;&#30340;&#20010;&#25968;&#26102;&#65292;&#20250;&#25193;&#23637;&#20869;&#23384;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Capacity is "</span> &lt;&lt; ivec.capacity<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25351;&#23450;&#22238;&#25910;&#22810;&#20313;&#20869;&#23384;&#65292;&#20855;&#20307;&#26159;&#21542;&#22238;&#25910;&#20915;&#23450;&#20110;&#32534;&#35793;&#22120;&#23454;&#29616;</span>
  ivec.shrink_to_fit<span style="color: #c678dd;">()</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Capacity is "</span> &lt;&lt; ivec.capacity<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">ivec &#30340;&#22823;&#23567;&#26159; 24 &#20010;&#23383;&#33410;&#65292;&#20445;&#23384;&#20102;&#19977;&#20010;&#25351;&#38024;&#65292;&#20998;&#21035;&#26159;&#21521;&#37327;&#22836;&#12289;&#21521;&#37327;&#23614;&#21518;&#12289;&#23481;&#37327;&#23614;&#21518;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #51afef;">sizeof</span><span style="color: #c678dd;">(</span>ivec<span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">Capacity</td>
<td class="org-left">is</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-left">Capacity</td>
<td class="org-left">is</td>
<td class="org-right">32</td>
</tr>

<tr>
<td class="org-left">Capacity</td>
<td class="org-left">is</td>
<td class="org-right">32</td>
</tr>

<tr>
<td class="org-left">Capacity</td>
<td class="org-left">is</td>
<td class="org-right">48</td>
</tr>

<tr>
<td class="org-left">Capacity</td>
<td class="org-left">is</td>
<td class="org-right">24</td>
</tr>

<tr>
<td class="org-left">24</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org89ba6df" class="outline-2">
<h2 id="org89ba6df"><span class="section-number-2">8</span> <code>std::string</code> 的一些操作</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">find_all</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">s</span>, <span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">pattern</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">string</span>::<span style="color: #ECBE7B;">size_type</span> <span style="color: #dcaeea;">pos</span> = 0;
  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span><span style="color: #98be65;">(</span>pos = s.find_first_of<span style="color: #a9a1e1;">(</span>pattern, pos<span style="color: #a9a1e1;">)</span><span style="color: #98be65;">)</span> != <span style="color: #a9a1e1;">string</span>::npos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    cout &lt;&lt; <span style="color: #98be65;">"Found index: "</span> &lt;&lt; pos
         &lt;&lt; <span style="color: #98be65;">", element is: "</span> &lt;&lt; s<span style="color: #98be65;">[</span>pos<span style="color: #98be65;">]</span> &lt;&lt; endl;
    ++pos;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">RET</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Con</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Callable</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">RET</span> <span style="color: #c678dd;">sum</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Con</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">container</span>, <span style="color: #ECBE7B;">Callable</span> <span style="color: #dcaeea;">convert</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">RET</span> <span style="color: #dcaeea;">ret</span><span style="color: #c678dd;">{}</span>;
  <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">Con</span>::<span style="color: #ECBE7B;">const_iterator</span> <span style="color: #dcaeea;">pos</span>;
  <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">Con</span>::<span style="color: #ECBE7B;">const_iterator</span> <span style="color: #dcaeea;">end</span> = container.end<span style="color: #c678dd;">()</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>pos = container.begin<span style="color: #98be65;">()</span>; pos != end; ++pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    ret += convert<span style="color: #98be65;">(</span>*pos<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">return</span> ret;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">s1</span><span style="color: #c678dd;">(</span><span style="color: #98be65;">"Hello, world!"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">s2</span><span style="color: #c678dd;">(</span><span style="color: #98be65;">"world"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">punct</span><span style="color: #c678dd;">(</span><span style="color: #98be65;">",.!"</span><span style="color: #c678dd;">)</span>;

  find_all<span style="color: #c678dd;">(</span>s1, punct<span style="color: #c678dd;">)</span>;

  <span style="color: #a9a1e1;">string</span>::<span style="color: #ECBE7B;">size_type</span> <span style="color: #dcaeea;">pos</span> = 0;
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span><span style="color: #98be65;">(</span>pos = s1.find<span style="color: #a9a1e1;">(</span>s2<span style="color: #a9a1e1;">)</span><span style="color: #98be65;">)</span> != <span style="color: #a9a1e1;">string</span>::npos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    cout &lt;&lt; <span style="color: #98be65;">"Find "</span> &lt;&lt; s2 &lt;&lt; <span style="color: #98be65;">" at index "</span> &lt;&lt; pos &lt;&lt; endl;
  <span style="color: #c678dd;">}</span>

  <span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">s3</span>  = to_string<span style="color: #c678dd;">(</span>123<span style="color: #c678dd;">)</span>;
  cout &lt;&lt; s3 &lt;&lt; endl;
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">ival</span> = stoi<span style="color: #c678dd;">(</span>s3<span style="color: #c678dd;">)</span>;
  cout &lt;&lt; ival &lt;&lt; endl;
  <span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">s4</span><span style="color: #c678dd;">(</span><span style="color: #98be65;">"pi = 3.14159"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">pi</span> = stod<span style="color: #c678dd;">(</span>s4.substr<span style="color: #98be65;">(</span>s4.find_first_of<span style="color: #a9a1e1;">(</span><span style="color: #98be65;">"+-.1234567890"</span><span style="color: #a9a1e1;">)</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  cout &lt;&lt; <span style="color: #98be65;">"Pi is "</span> &lt;&lt; pi &lt;&lt; endl;

  <span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">string_with_digitals</span><span style="color: #c678dd;">{</span>
    <span style="color: #98be65;">"3.14159"</span>,
    <span style="color: #98be65;">"2.71828"</span>,
    <span style="color: #98be65;">"1.41421"</span>
  <span style="color: #c678dd;">}</span>;
  cout &lt;&lt; <span style="color: #98be65;">"Sum of int is "</span> &lt;&lt; sum<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;(</span>string_with_digitals, <span style="color: #98be65;">[](</span><span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">s</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
    <span style="color: #51afef;">return</span> stoi<span style="color: #a9a1e1;">(</span>s<span style="color: #a9a1e1;">)</span>;
  <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span> &lt;&lt; endl;
  cout &lt;&lt; <span style="color: #98be65;">"Sum of double is "</span> &lt;&lt; sum<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #c678dd;">&gt;(</span>string_with_digitals, <span style="color: #98be65;">[](</span><span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">s</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
    <span style="color: #51afef;">return</span> stod<span style="color: #a9a1e1;">(</span>s<span style="color: #a9a1e1;">)</span>;
  <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span> &lt;&lt; endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-right">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Found</td>
<td class="org-left">index:</td>
<td class="org-left">5,</td>
<td class="org-left">element</td>
<td class="org-right">is:</td>
<td class="org-left">,</td>
</tr>

<tr>
<td class="org-left">Found</td>
<td class="org-left">index:</td>
<td class="org-left">12,</td>
<td class="org-left">element</td>
<td class="org-right">is:</td>
<td class="org-left">!</td>
</tr>

<tr>
<td class="org-left">Find</td>
<td class="org-left">world</td>
<td class="org-left">at</td>
<td class="org-left">index</td>
<td class="org-right">7</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">123</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">123</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Pi</td>
<td class="org-left">is</td>
<td class="org-left">3.14159</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Sum</td>
<td class="org-left">of</td>
<td class="org-left">int</td>
<td class="org-left">is</td>
<td class="org-right">6</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Sum</td>
<td class="org-left">of</td>
<td class="org-left">double</td>
<td class="org-left">is</td>
<td class="org-right">7.27408</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org59d5f69" class="outline-2">
<h2 id="org59d5f69"><span class="section-number-2">9</span> 泛型算法</h2>
<div class="outline-text-2" id="text-9">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">list</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span><span style="color: #c678dd;">{</span>1, 2, 3, 4, 5<span style="color: #c678dd;">}</span>;
  <span style="color: #ECBE7B;">list</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ilist</span><span style="color: #c678dd;">{</span>1, 2, 3, 4, 5<span style="color: #c678dd;">}</span>;
  cout &lt;&lt; <span style="color: #98be65;">"ivec and ilist is"</span>
       &lt;&lt; <span style="color: #c678dd;">(</span>equal<span style="color: #98be65;">(</span>ivec.cbegin<span style="color: #a9a1e1;">()</span>, ivec.cend<span style="color: #a9a1e1;">()</span>, ilist.cbegin<span style="color: #a9a1e1;">()</span><span style="color: #98be65;">)</span> ? <span style="color: #98be65;">" "</span> : <span style="color: #98be65;">" not "</span><span style="color: #c678dd;">)</span>
       &lt;&lt; <span style="color: #98be65;">"same."</span> &lt;&lt; endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<pre class="example">
ivec and ilist is same.
</pre>


<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">numeric</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span><span style="color: #c678dd;">{</span>1.2, 2.9, 3.4, 4.5, 5.5<span style="color: #c678dd;">}</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#27880;&#24847;&#23545;&#20110;&#27867;&#22411;&#31639;&#27861;&#31532;&#19977;&#20010;&#21442;&#25968;&#38750;&#24120;&#37325;&#35201;&#65292;&#20915;&#23450;&#20102;&#36820;&#22238;&#20540;&#31867;&#22411;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Sum is "</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::accumulate<span style="color: #c678dd;">(</span>ivec.cbegin<span style="color: #98be65;">()</span>, ivec.cend<span style="color: #98be65;">()</span>, 0<span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Sum is "</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::accumulate<span style="color: #c678dd;">(</span>ivec.cbegin<span style="color: #98be65;">()</span>, ivec.cend<span style="color: #98be65;">()</span>, .0<span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">Sum</td>
<td class="org-left">is</td>
<td class="org-right">15</td>
</tr>

<tr>
<td class="org-left">Sum</td>
<td class="org-left">is</td>
<td class="org-right">17.5</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print_items</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">__pos</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__end</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>__pos == __end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"["</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#27492;&#22788;&#37319;&#29992; __pos + 1 != __end &#32780;&#19981;&#26159; __pos != __end - 1 &#26159;&#22240;&#20026; list &#30340;&#36845;&#20195;&#22120;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#27809;&#26377;&#37325;&#36733;&#20943;&#25805;&#20316;</span>
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>; __pos + 1 != __end; ++__pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"&#65292; "</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"]"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span><span style="color: #c678dd;">{</span>0, 1, 2, 3, 0, 1, 2<span style="color: #c678dd;">}</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec_new</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558; ivec &#20013;&#30340; 0 &#26367;&#25442;&#20026; 42 &#24182;&#20889;&#20837; ivec_new&#65292;&#27880;&#24847;&#27492;&#22788;&#30340; back_inserter &#29983;&#25104;&#20102;&#19968;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20010;&#25554;&#20837;&#36845;&#20195;&#22120;</span>
  <span style="color: #a9a1e1;">std</span>::replace_copy<span style="color: #c678dd;">(</span>ivec.begin<span style="color: #98be65;">()</span>, ivec.end<span style="color: #98be65;">()</span>, <span style="color: #a9a1e1;">std</span>::back_inserter<span style="color: #98be65;">(</span>ivec_new<span style="color: #98be65;">)</span>, 0, 42<span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>ivec_new.cbegin<span style="color: #98be65;">()</span>, ivec_new.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558;&#22823;&#20110; 1 &#30340;&#20540;&#26367;&#25442;&#20026; 1&#65292;&#27880;&#24847;&#27492;&#22788;&#22240;&#20026; ivec_new &#20013;&#26412;&#26469;&#24050;&#32463;&#26377;&#30456;&#21516;&#25968;&#37327;&#30340;&#20540;&#65292;&#30452;&#25509;&#35206;&#30422;</span>
  <span style="color: #a9a1e1;">std</span>::replace_copy_if<span style="color: #c678dd;">(</span>ivec.begin<span style="color: #98be65;">()</span>, ivec.end<span style="color: #98be65;">()</span>, ivec_new.begin<span style="color: #98be65;">()</span>,
                       <span style="color: #98be65;">[](</span><span style="color: #ECBE7B;">int</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">elem</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span> <span style="color: #51afef;">return</span> elem &gt; 1; <span style="color: #98be65;">}</span>, 1<span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>ivec_new.cbegin<span style="color: #98be65;">()</span>, ivec_new.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#30452;&#25509;&#22312; ivec &#19978;&#20462;&#25913;</span>
  <span style="color: #a9a1e1;">std</span>::replace_if<span style="color: #c678dd;">(</span>ivec.begin<span style="color: #98be65;">()</span>, ivec.end<span style="color: #98be65;">()</span>,
                  <span style="color: #98be65;">[](</span><span style="color: #ECBE7B;">int</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">elem</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span> <span style="color: #51afef;">return</span> elem &gt; 1; <span style="color: #98be65;">}</span>, 1<span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>ivec.cbegin<span style="color: #98be65;">()</span>, ivec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #a9a1e1;">std</span>::fill<span style="color: #c678dd;">(</span>ivec.begin<span style="color: #98be65;">()</span>, ivec.end<span style="color: #98be65;">()</span>, 0<span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>ivec.cbegin<span style="color: #98be65;">()</span>, ivec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">count</span> = 0; count &lt; 5; ++count<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    *<span style="color: #a9a1e1;">std</span>::inserter<span style="color: #98be65;">(</span>ivec, ivec.begin<span style="color: #a9a1e1;">()</span> + 2<span style="color: #98be65;">)</span> = count + 1;
  <span style="color: #c678dd;">}</span>
  print_items<span style="color: #c678dd;">(</span>ivec.cbegin<span style="color: #98be65;">()</span>, ivec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">back_insertor</span> = <span style="color: #a9a1e1;">std</span>::back_inserter<span style="color: #c678dd;">(</span>ivec_new<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">count</span> = 0; count &lt; 5; ++count<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    *back_insertor = count + 1;
  <span style="color: #c678dd;">}</span>
  print_items<span style="color: #c678dd;">(</span>ivec_new.cbegin<span style="color: #98be65;">()</span>, ivec_new.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[42，</td>
<td class="org-left">1，</td>
<td class="org-left">2，</td>
<td class="org-left">3，</td>
<td class="org-left">42，</td>
<td class="org-left">1，</td>
<td class="org-left">2]</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">[0，</td>
<td class="org-left">1，</td>
<td class="org-left">1，</td>
<td class="org-left">1，</td>
<td class="org-left">0，</td>
<td class="org-left">1，</td>
<td class="org-left">1]</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">[0，</td>
<td class="org-left">1，</td>
<td class="org-left">1，</td>
<td class="org-left">1，</td>
<td class="org-left">0，</td>
<td class="org-left">1，</td>
<td class="org-left">1]</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">[0，</td>
<td class="org-left">0，</td>
<td class="org-left">0，</td>
<td class="org-left">0，</td>
<td class="org-left">0，</td>
<td class="org-left">0，</td>
<td class="org-left">0]</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">[0，</td>
<td class="org-left">0，</td>
<td class="org-left">5，</td>
<td class="org-left">4，</td>
<td class="org-left">3，</td>
<td class="org-left">2，</td>
<td class="org-left">1，</td>
<td class="org-left">0，</td>
<td class="org-left">0，</td>
<td class="org-left">0，</td>
<td class="org-left">0，</td>
<td class="org-left">0]</td>
</tr>

<tr>
<td class="org-left">[0，</td>
<td class="org-left">1，</td>
<td class="org-left">1，</td>
<td class="org-left">1，</td>
<td class="org-left">0，</td>
<td class="org-left">1，</td>
<td class="org-left">1，</td>
<td class="org-left">1，</td>
<td class="org-left">2，</td>
<td class="org-left">3，</td>
<td class="org-left">4，</td>
<td class="org-left">5]</td>
</tr>
</tbody>
</table>

<p>
消除重复的单词
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">deque</span><span style="color: #51afef;">&gt;</span>&gt;

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print_items</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">__pos</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__end</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>__pos == __end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"["</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>; __pos + 1 != __end; ++__pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"&#65292; "</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"]"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Con</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">elim_dups</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Con</span>&amp; <span style="color: #dcaeea;">container</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25490;&#24207;</span>
  sort<span style="color: #c678dd;">(</span>container.begin<span style="color: #98be65;">()</span>, container.end<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558;&#26080;&#37325;&#22797;&#30340;&#20803;&#32032;&#25918;&#22312;&#24320;&#22836;&#65292;&#24182;&#36820;&#22238;&#26368;&#21518;&#19968;&#20010;&#19981;&#37325;&#22797;&#20803;&#32032;&#20043;&#21518;&#20301;&#32622;&#30340;&#36845;&#20195;&#22120;</span>
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">end_unique</span> = unique<span style="color: #c678dd;">(</span>container.begin<span style="color: #98be65;">()</span>, container.end<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#28040;&#38500;&#37325;&#22797;&#30340;&#20803;&#32032;</span>
  container.erase<span style="color: #c678dd;">(</span>end_unique, container.end<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span><span style="color: #c678dd;">{</span>1, 0, 2, 3, 1, 2, 0<span style="color: #c678dd;">}</span>;
  <span style="color: #ECBE7B;">deque</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">sdeque</span><span style="color: #c678dd;">{</span>
    <span style="color: #98be65;">"hello"</span>,
    <span style="color: #98be65;">"world"</span>,
    <span style="color: #98be65;">"C++"</span>,
    <span style="color: #98be65;">"hello"</span>,
    <span style="color: #98be65;">"C++"</span>
  <span style="color: #c678dd;">}</span>;
  elim_dups<span style="color: #c678dd;">(</span>ivec<span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>ivec.cbegin<span style="color: #98be65;">()</span>, ivec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
  elim_dups<span style="color: #c678dd;">(</span>sdeque<span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>sdeque.cbegin<span style="color: #98be65;">()</span>, sdeque.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[0，</td>
<td class="org-left">1，</td>
<td class="org-left">2，</td>
<td class="org-left">3]</td>
</tr>

<tr>
<td class="org-left">[C++，</td>
<td class="org-left">hello，</td>
<td class="org-left">world]</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
谓词
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print_items</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">__pos</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__end</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>__pos == __end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"["</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>; __pos + 1 != __end; ++__pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"&#65292; "</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"]"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20132;&#25442;&#36845;&#20195;&#22120;&#20803;&#32032;&#30340;&#27169;&#26495;&#23454;&#29616;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">swap</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__iter_a</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__iter_b</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">iterator_traits</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Iter</span><span style="color: #c678dd;">&gt;</span>::<span style="color: #ECBE7B;">value_type</span> <span style="color: #dcaeea;">tmp</span>;
  tmp = *__iter_a;
  *__iter_a = *__iter_b;
  *__iter_b  = tmp;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20882;&#27873;&#25490;&#24207;&#30340;&#27169;&#26495;&#23454;&#29616;&#65292;&#27492;&#22788;&#30340; Predicate &#31216;&#20026;&#20108;&#20803;&#35859;&#35789;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Predicate</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">sort</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__beg</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">__end</span>, <span style="color: #ECBE7B;">Predicate</span> <span style="color: #dcaeea;">__predicate</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">pos</span> = __beg;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>; __beg + 1 != __end; --__end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">for</span> <span style="color: #98be65;">(</span>pos = __beg; pos + 1 != __end; ++pos<span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">if</span> <span style="color: #a9a1e1;">(</span><span style="color: #51afef; font-weight: bold;">!</span>__predicate<span style="color: #4db5bd;">(</span>*pos, *<span style="color: #51afef;">(</span>pos + 1<span style="color: #51afef;">)</span><span style="color: #4db5bd;">)</span><span style="color: #a9a1e1;">)</span> <span style="color: #a9a1e1;">{</span>
        swap<span style="color: #4db5bd;">(</span>pos, pos + 1<span style="color: #4db5bd;">)</span>;
      <span style="color: #a9a1e1;">}</span>
    <span style="color: #98be65;">}</span>
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">svec</span><span style="color: #c678dd;">{</span>
    <span style="color: #98be65;">"hello"</span>,
    <span style="color: #98be65;">"world"</span>,
    <span style="color: #98be65;">"evil"</span>,
    <span style="color: #98be65;">"C++"</span>,
    <span style="color: #98be65;">"elegant"</span>,
    <span style="color: #98be65;">"Python"</span>
  <span style="color: #c678dd;">}</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#33258;&#23450;&#20041;&#25490;&#24207;&#26465;&#20214;&#65292;&#27492;&#22788;&#20351;&#29992;&#20102; lambda &#27169;&#26495;&#65292;C++20 &#25165;&#21152;&#20837;&#30340;&#29305;&#24615;</span>
  ::sort<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, <span style="color: #98be65;">[]&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #98be65;">&gt;(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #dcaeea;">T</span> <span style="color: #51afef;">const</span>&amp; b<span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">return</span> a &lt; b;
    <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, svec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  ::sort<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, <span style="color: #98be65;">[]&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #98be65;">&gt;(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #dcaeea;">T</span> <span style="color: #51afef;">const</span>&amp; b<span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">return</span> a.size<span style="color: #a9a1e1;">()</span> &lt; b.size<span style="color: #a9a1e1;">()</span>;
    <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, svec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558; svec &#20808;&#25353;&#23383;&#20856;&#24207;&#37325;&#25490;&#65292;&#20877;&#20351;&#29992; stable_sort &#20445;&#25345;&#30456;&#21516;&#38271;&#24230;&#30340; string &#30340;&#39034;&#24207;</span>
  <span style="color: #a9a1e1;">std</span>::sort<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::stable_sort<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, <span style="color: #98be65;">[]&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #98be65;">&gt;(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #dcaeea;">T</span> <span style="color: #51afef;">const</span>&amp; b<span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">return</span> a.size<span style="color: #a9a1e1;">()</span> &lt; b.size<span style="color: #a9a1e1;">()</span>;
    <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, svec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#27492;&#22788;&#38656;&#35201;&#26174;&#24335;&#25351;&#26126;&#36845;&#20195;&#22120;&#31867;&#22411;&#65292;&#33509;&#20351;&#29992; auto &#20250;&#36820;&#22238; normal_iterator &#31867;&#22411;&#65292;&#38656;&#35201;&#20351;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#29992; static_cast &#36827;&#34892;&#31867;&#22411;&#36716;&#25442;</span>
  <span style="color: #a9a1e1;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span>::<span style="color: #ECBE7B;">const_iterator</span> <span style="color: #dcaeea;">iter_sep</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25171;&#21360;&#38271;&#24230;&#22823;&#20110; 4 &#30340;&#20803;&#32032;&#65292;partition &#23558;&#20803;&#32032;&#20998;&#20026;&#20004;&#37096;&#20998;&#65292;&#21069;&#38754;&#20026;&#28385;&#36275;&#19968;&#20803;&#35859;&#35789;&#30340;&#20803;&#32032;&#65292;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36820;&#22238;&#20540;&#20026;&#19981;&#28385;&#36275;&#26465;&#20214;&#30340;&#26368;&#21518;&#19968;&#20010;&#20803;&#32032;&#30340;&#21518;&#19968;&#20010;&#36845;&#20195;&#22120;</span>
  iter_sep = <span style="color: #a9a1e1;">std</span>::partition<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, <span style="color: #98be65;">[]&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #98be65;">&gt;(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">a</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">return</span> a.size<span style="color: #a9a1e1;">()</span> &gt; 4;
    <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, iter_sep<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[C++，</td>
<td class="org-left">Python，</td>
<td class="org-left">elegant，</td>
<td class="org-left">evil，</td>
<td class="org-left">hello，</td>
<td class="org-left">world]</td>
</tr>

<tr>
<td class="org-left">[C++，</td>
<td class="org-left">evil，</td>
<td class="org-left">world，</td>
<td class="org-left">hello，</td>
<td class="org-left">Python，</td>
<td class="org-left">elegant]</td>
</tr>

<tr>
<td class="org-left">[C++，</td>
<td class="org-left">evil，</td>
<td class="org-left">hello，</td>
<td class="org-left">world，</td>
<td class="org-left">Python，</td>
<td class="org-left">elegant]</td>
</tr>

<tr>
<td class="org-left">[elegant，</td>
<td class="org-left">Python，</td>
<td class="org-left">hello，</td>
<td class="org-left">world]</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
lambda 表达式，闭包
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">functional</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print_items</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">__pos</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__end</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>__pos == __end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"["</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>; __pos + 1 != __end; ++__pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"&#65292; "</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"]"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#19968;&#20010;&#38381;&#21253;&#27169;&#26495;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">auto</span> <span style="color: #c678dd;">longer_than</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">__pivot</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36820;&#22238;&#19968;&#20010;&#19968;&#20803;&#35859;&#35789;&#65288;&#27169;&#26495;&#35859;&#35789;&#65289;&#65292;lambda &#34920;&#36798;&#24335;&#25335;&#36125;&#25429;&#33719;&#20102; __pivot &#23616;&#37096;&#21464;&#37327;&#20316;&#20026;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25104;&#21592;&#65292;&#20043;&#21518;&#27599;&#27425;&#35843;&#29992;&#35859;&#35789;&#37117;&#21487;&#20351;&#29992; __pivot &#30340;&#20540;&#12290;&#33509;&#37319;&#29992;&#24341;&#29992;&#25429;&#33719;&#21017;&#38656;&#27880;&#24847;&#29983;&#21629;&#21608;&#26399;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21644;&#21464;&#37327;&#21464;&#21270;</span>
  <span style="color: #51afef;">return</span> <span style="color: #c678dd;">[</span>__pivot<span style="color: #c678dd;">]&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">U</span><span style="color: #c678dd;">&gt;</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">U</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">elem</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #51afef;">return</span> elem.size<span style="color: #98be65;">()</span> &gt; __pivot; <span style="color: #c678dd;">}</span>;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">U</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">bool</span> <span style="color: #c678dd;">longer_than</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">U</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">elem</span>, <span style="color: #ECBE7B;">T</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">__pivot</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> elem.size<span style="color: #c678dd;">()</span> &gt; __pivot;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">svec</span><span style="color: #c678dd;">{</span>
    <span style="color: #98be65;">"hello"</span>,
    <span style="color: #98be65;">"world"</span>,
    <span style="color: #98be65;">"evil"</span>,
    <span style="color: #98be65;">"C++"</span>,
    <span style="color: #98be65;">"elegant"</span>,
    <span style="color: #98be65;">"Python"</span>
  <span style="color: #c678dd;">}</span>;

  <span style="color: #a9a1e1;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span>::<span style="color: #ECBE7B;">const_iterator</span> <span style="color: #dcaeea;">iter_sep</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25171;&#21360;&#38271;&#24230;&#22823;&#20110; 4 &#30340;&#20803;&#32032;</span>
  iter_sep = partition<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, longer_than<span style="color: #98be65;">(</span>4<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, iter_sep<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25171;&#21360;&#38271;&#24230;&#22823;&#20110; 5 &#30340;&#20803;&#32032;</span>
  iter_sep = partition<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, longer_than<span style="color: #98be65;">(</span>5<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, iter_sep<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20351;&#29992; std::bind &#32465;&#23450;&#21442;&#25968;&#65292;&#22312; functional &#22836;&#25991;&#20214;&#20013;</span>
  iter_sep = partition<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, bind<span style="color: #98be65;">(</span>longer_than&lt;string, size_t&gt;, <span style="color: #a9a1e1;">placeholders</span>::_1, 4<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, iter_sep<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[hello，</td>
<td class="org-left">world，</td>
<td class="org-left">Python，</td>
<td class="org-left">elegant]</td>
</tr>

<tr>
<td class="org-left">[elegant，</td>
<td class="org-left">Python]</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">[elegant，</td>
<td class="org-left">Python，</td>
<td class="org-left">world，</td>
<td class="org-left">hello]</td>
</tr>
</tbody>
</table>

<p>
<code>std::bind</code> 的用法
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">functional</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;
<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">placeholders</span>;

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Arg</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Arg</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">arg</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  cout &lt;&lt; arg &lt;&lt; endl;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Arg</span>, <span style="color: #51afef;">typename</span><span style="color: #c678dd;">...</span> <span style="color: #ECBE7B;">Args</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Arg</span> <span style="color: #dcaeea;">arg</span>, <span style="color: #ECBE7B;">Args</span><span style="color: #c678dd;">...</span> <span style="color: #dcaeea;">args</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  cout &lt;&lt; arg &lt;&lt; <span style="color: #98be65;">", "</span>;
  print<span style="color: #c678dd;">(</span>args<span style="color: #c678dd;">...</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  print<span style="color: #c678dd;">(</span><span style="color: #98be65;">"evil"</span>, <span style="color: #98be65;">"C++"</span>, <span style="color: #98be65;">"elegant"</span>, <span style="color: #98be65;">"Python"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">f</span> = bind<span style="color: #c678dd;">(</span>print&lt;string, string, string, string&gt;, <span style="color: #98be65;">"evil"</span>, _1, <span style="color: #98be65;">"elegant"</span>, _2<span style="color: #c678dd;">)</span>;
  f<span style="color: #c678dd;">(</span><span style="color: #98be65;">"C++"</span>, <span style="color: #98be65;">"Python"</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">evil</td>
<td class="org-left">C++</td>
<td class="org-left">elegant</td>
<td class="org-left">Python</td>
</tr>

<tr>
<td class="org-left">evil</td>
<td class="org-left">C++</td>
<td class="org-left">elegant</td>
<td class="org-left">Python</td>
</tr>
</tbody>
</table>

<p>
使用 <code>std::bind</code> 重排参数顺序
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">functional</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;
<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">placeholders</span>;

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print_items</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">__pos</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__end</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>__pos == __end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"["</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>; __pos + 1 != __end; ++__pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"&#65292; "</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"]"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T1</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T2</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">bool</span> <span style="color: #c678dd;">shorter</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">T1</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #ECBE7B;">T2</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">b</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> a.size<span style="color: #c678dd;">()</span> &gt; b.size<span style="color: #c678dd;">()</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">svec</span><span style="color: #c678dd;">{</span>
    <span style="color: #98be65;">"devil"</span>,
    <span style="color: #98be65;">"C++"</span>,
    <span style="color: #98be65;">"elegant"</span>,
    <span style="color: #98be65;">"Python"</span>
  <span style="color: #c678dd;">}</span>;

  sort<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, shorter&lt;string, string&gt;<span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, svec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  sort<span style="color: #c678dd;">(</span>svec.begin<span style="color: #98be65;">()</span>, svec.end<span style="color: #98be65;">()</span>, bind<span style="color: #98be65;">(</span>shorter&lt;string, string&gt;, _2, _1<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>svec.cbegin<span style="color: #98be65;">()</span>, svec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[elegant，</td>
<td class="org-left">Python，</td>
<td class="org-left">devil，</td>
<td class="org-left">C++]</td>
</tr>

<tr>
<td class="org-left">[C++，</td>
<td class="org-left">devil，</td>
<td class="org-left">Python，</td>
<td class="org-left">elegant]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org5bfd3e0" class="outline-2">
<h2 id="org5bfd3e0"><span class="section-number-2">10</span> 迭代器的一些高级用法</h2>
<div class="outline-text-2" id="text-10">
<p>
从字符串流读取数据
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">sstream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iterator</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">numeric</span><span style="color: #51afef;">&gt;</span>&gt;

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print_items</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">__pos</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__end</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>__pos == __end<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23450;&#20041;&#19968;&#20010; pre &#21464;&#37327;&#32531;&#23384;&#36845;&#20195;&#22120;&#30340;&#36820;&#22238;&#20540;&#65292;&#23545;&#20110;&#27969;&#36845;&#20195;&#22120;&#26080;&#27861;&#39044;&#27979;&#20309;&#26102;&#21040;&#36798;&#27969;&#30340;&#23614;&#37096;</span>
  <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">Iter</span>::<span style="color: #ECBE7B;">value_type</span> <span style="color: #dcaeea;">pre</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"["</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>pre = *__pos++; __pos != __end; pre = *__pos++<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; pre &lt;&lt; <span style="color: #98be65;">"&#65292; "</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; pre &lt;&lt; <span style="color: #98be65;">"]"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20174;&#27969;&#20013;&#35835;&#21462;&#25968;&#25454;&#21040;&#25554;&#20837;&#36845;&#20195;&#22120;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">IStream</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Insert_Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">data_from_stream</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">IStream</span>&amp; <span style="color: #dcaeea;">__is</span>, <span style="color: #ECBE7B;">Insert_Iter</span> <span style="color: #dcaeea;">__insert_iter</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #ECBE7B;">TRICK</span><span style="color: #5B6268;"> &#33795;&#21462;&#36845;&#20195;&#22120;&#25152;&#25351;&#20803;&#32032;&#30340;&#31867;&#22411;&#65292;&#20294;&#35813;&#31867;&#22411;&#26080;&#27861;&#30452;&#25509;&#36890;&#36807;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">Insert_Iter::value_type &#33719;&#21462;&#65292;&#30452;&#25509;&#33719;&#21462;&#20026; void&#65292;&#21442;&#29031;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">https://stackoverflow.com/questions/16165635/why-the-value-type-difference-type-pointer-reference-of-back-insert-iterator-fro</span>
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">Type</span> = <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">Insert_Iter</span>::<span style="color: #a9a1e1;">container_type</span>::value_type;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21021;&#22987;&#21270; __is &#27969;&#30340;&#19968;&#20010; Type &#22411;&#36845;&#20195;&#22120;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">istream_iterator</span><span style="color: #c678dd;">&lt;</span>Type<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">is_iter</span><span style="color: #c678dd;">(</span>__is<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#40664;&#35748;&#21021;&#22987;&#21270;&#20026;&#23614;&#21518;&#36845;&#20195;&#22120;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">istream_iterator</span><span style="color: #c678dd;">&lt;</span>Type<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">eof</span>;

  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span>is_iter != eof<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    *__insert_iter = *is_iter++;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21021;&#22987;&#21270;&#19968;&#20010;&#23383;&#31526;&#20018;&#27969;</span>
  <span style="color: #ECBE7B;">stringstream</span> <span style="color: #dcaeea;">ss</span><span style="color: #c678dd;">{</span><span style="color: #98be65;">"123 456 789"</span><span style="color: #c678dd;">}</span>;
  <span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20351;&#29992;&#33258;&#23450;&#20041;&#30340;&#26041;&#24335;&#23558;&#27969;&#20013;&#25968;&#25454;&#20889;&#20837;&#36755;&#20986;&#27969;</span>
  data_from_stream<span style="color: #c678dd;">(</span>ss, <span style="color: #a9a1e1;">std</span>::back_inserter<span style="color: #98be65;">(</span>ivec<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>ivec.cbegin<span style="color: #98be65;">()</span>, ivec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26631;&#20934;&#24211;&#25552;&#20379;&#20102;&#26356;&#20026;&#31616;&#20415;&#30340;&#26041;&#24335;&#65292;&#20174;&#36755;&#20837;&#27969;&#25335;&#36125;&#21040; vector</span>
  <span style="color: #ECBE7B;">stringstream</span> <span style="color: #dcaeea;">ssd</span><span style="color: #c678dd;">{</span><span style="color: #98be65;">"3.14 1.41 2.56"</span><span style="color: #c678dd;">}</span>;
  <span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">dvec</span>;
  <span style="color: #a9a1e1;">std</span>::copy<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::istream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #98be65;">&gt;(</span>ssd<span style="color: #98be65;">)</span>,
            <span style="color: #a9a1e1;">std</span>::istream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #98be65;">&gt;()</span>,
            <span style="color: #a9a1e1;">std</span>::back_inserter<span style="color: #98be65;">(</span>dvec<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  print_items<span style="color: #c678dd;">(</span>dvec.cbegin<span style="color: #98be65;">()</span>, dvec.cend<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#29978;&#33267;&#36824;&#21487;&#20197;&#26356;&#31616;&#21333;&#65292;&#30452;&#25509;&#20174;&#36755;&#20837;&#27969;&#25335;&#36125;&#21040;&#36755;&#20986;&#27969;</span>
  <span style="color: #ECBE7B;">stringstream</span> <span style="color: #dcaeea;">ssd2</span><span style="color: #c678dd;">{</span><span style="color: #98be65;">"3.14 1.41 2.56"</span><span style="color: #c678dd;">}</span>;
  <span style="color: #a9a1e1;">std</span>::copy<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::istream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #98be65;">&gt;(</span>ssd2<span style="color: #98be65;">)</span>,
            <span style="color: #a9a1e1;">std</span>::istream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #98be65;">&gt;()</span>,
            <span style="color: #a9a1e1;">std</span>::ostream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #98be65;">&gt;(</span><span style="color: #a9a1e1;">std</span>::cout, <span style="color: #98be65;">", "</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25110;&#32773;&#21033;&#29992;&#27867;&#22411;&#30340; print_items &#20989;&#25968;&#27169;&#26495;&#65292;&#20174;&#36755;&#20837;&#27969;&#33258;&#23450;&#20041;&#36755;&#20986;</span>
  <span style="color: #ECBE7B;">stringstream</span> <span style="color: #dcaeea;">ssd3</span><span style="color: #c678dd;">{</span><span style="color: #98be65;">"3.14 1.41 2.56"</span><span style="color: #c678dd;">}</span>;
  print_items<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::istream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #98be65;">&gt;(</span>ssd3<span style="color: #98be65;">)</span>,
              <span style="color: #a9a1e1;">std</span>::istream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">double</span><span style="color: #98be65;">&gt;()</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[123，</td>
<td class="org-left">456，</td>
<td class="org-left">789]</td>
</tr>

<tr>
<td class="org-left">[3.14，</td>
<td class="org-left">1.41，</td>
<td class="org-left">2.56]</td>
</tr>

<tr>
<td class="org-left">3.14,</td>
<td class="org-left">1.41,</td>
<td class="org-left">2.56,</td>
</tr>

<tr>
<td class="org-left">[3.14，</td>
<td class="org-left">1.41，</td>
<td class="org-left">2.56]</td>
</tr>
</tbody>
</table>

<p>
将数据写到输出流迭代器
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">sstream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iterator</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20174;&#27969;&#20013;&#35835;&#21462;&#25968;&#25454;&#65292;&#25490;&#24207;&#21518;&#36755;&#20986;&#21040;&#26631;&#20934;&#36755;&#20986;&#27969;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">stringstream</span> <span style="color: #dcaeea;">ss</span><span style="color: #c678dd;">{</span><span style="color: #98be65;">"1 3 2 5 4"</span><span style="color: #c678dd;">}</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">istream_iterator</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">is_iter</span><span style="color: #c678dd;">(</span>ss<span style="color: #c678dd;">)</span>, <span style="color: #dcaeea;">eof</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36755;&#20837;&#27969;&#36845;&#20195;&#22120;&#19981;&#25903;&#25345;&#38543;&#26426;&#35775;&#38382;&#65292;&#22240;&#27492;&#19981;&#33021;&#30452;&#25509;&#25490;&#24207;</span>
  <span style="color: #a9a1e1;">std</span>::copy<span style="color: #c678dd;">(</span>is_iter, eof, <span style="color: #a9a1e1;">std</span>::back_inserter<span style="color: #98be65;">(</span>ivec<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::sort<span style="color: #c678dd;">(</span>ivec.begin<span style="color: #98be65;">()</span>, ivec.end<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream_iterator</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">os_iter</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::cout, <span style="color: #98be65;">" "</span><span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20174;&#27492;&#22788;&#21487;&#20197;&#30475;&#20986;&#27969;&#36845;&#20195;&#22120;&#19982;&#25554;&#20837;&#36845;&#20195;&#22120;&#31867;&#20284;</span>
  <span style="color: #a9a1e1;">std</span>::copy<span style="color: #c678dd;">(</span>ivec.begin<span style="color: #98be65;">()</span>, ivec.end<span style="color: #98be65;">()</span>, os_iter<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<pre class="example">
1 2 3 4 5
</pre>
</div>
</div>

<div id="outline-container-org99ad279" class="outline-2">
<h2 id="org99ad279"><span class="section-number-2">11</span> 关联容器</h2>
<div class="outline-text-2" id="text-11">
<p>
统计单词数量
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">sstream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iterator</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">map</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">fmt/core.h</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">word_count</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__text</span>, <span style="color: #ECBE7B;">ostream_iterator</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">__os_iter</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">stringstream</span> <span style="color: #dcaeea;">ss</span><span style="color: #c678dd;">(</span>__text<span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">istream_iterator</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">is_iter</span><span style="color: #c678dd;">(</span>ss<span style="color: #c678dd;">)</span>, <span style="color: #dcaeea;">eof</span>;
  <span style="color: #ECBE7B;">map</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">string</span>, <span style="color: #ECBE7B;">size_t</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">counter</span>;

  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span>is_iter != eof<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">buf</span> = *is_iter++;
    transform<span style="color: #98be65;">(</span>buf.begin<span style="color: #a9a1e1;">()</span>, buf.end<span style="color: #a9a1e1;">()</span>,
              buf.begin<span style="color: #a9a1e1;">()</span>, <span style="color: #51afef;">static_cast</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #4db5bd;">(</span>*<span style="color: #4db5bd;">)(</span><span style="color: #ECBE7B;">int</span><span style="color: #4db5bd;">)</span><span style="color: #a9a1e1;">&gt;(</span>tolower<span style="color: #a9a1e1;">)</span><span style="color: #98be65;">)</span>;
    ++counter<span style="color: #98be65;">[</span>buf<span style="color: #98be65;">]</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #51afef;">auto</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">w</span> : counter<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    *__os_iter++ = <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #98be65;">(</span><span style="color: #98be65;">"{0} occurs {1} times."</span>, w.first, w.second<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">text</span><span style="color: #c678dd;">(</span><span style="color: #98be65;">"Hello world hello Evil C++ hello c++ world"</span><span style="color: #c678dd;">)</span>;
  word_count<span style="color: #c678dd;">(</span>text, ostream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;(</span>cout, <span style="color: #98be65;">"\n"</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<p>
在 <code>set</code> 中自定义比较函数
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">set</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">{</span>
<span style="color: #51afef;">public</span>:
  <span style="color: #c678dd;">Point</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">__x</span> = .0, <span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">__y</span> = .0<span style="color: #c678dd;">)</span> : x<span style="color: #c678dd;">(</span>__x<span style="color: #c678dd;">)</span>, y<span style="color: #c678dd;">(</span>__y<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">friend</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span> <span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">p</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    os &lt;&lt; <span style="color: #98be65;">"("</span> &lt;&lt; p.x &lt;&lt; <span style="color: #98be65;">", "</span> &lt;&lt; p.y &lt;&lt; <span style="color: #98be65;">")"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">x</span>, <span style="color: #dcaeea;">y</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #ECBE7B;">bool</span> <span style="color: #c678dd;">compare_point</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">b</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>a.x == 0 &amp;&amp; b.x == 0<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> a.y &lt; b.y;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>a.x == 0<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">false</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>b.x == 0<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">true</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #51afef;">return</span> a.y / a.x &lt; b.y / b.x;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">bool</span> <span style="color: #c678dd;">strict_compare_point</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">b</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> a.x &lt; b.x || a.y &lt; b.y;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">set</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Point</span>, <span style="color: #51afef;">decltype</span><span style="color: #98be65;">(</span>compare_point<span style="color: #98be65;">)</span>*<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">points</span><span style="color: #c678dd;">(</span>compare_point<span style="color: #c678dd;">)</span>;
  points.emplace<span style="color: #c678dd;">(</span>1, 2<span style="color: #c678dd;">)</span>;
  points.emplace<span style="color: #c678dd;">(</span>1, 3<span style="color: #c678dd;">)</span>;
  points.emplace<span style="color: #c678dd;">(</span>2, 4<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">point</span> : points<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; point;
  <span style="color: #c678dd;">}</span>

  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">set</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Point</span>, <span style="color: #51afef;">decltype</span><span style="color: #98be65;">(</span>strict_compare_point<span style="color: #98be65;">)</span>*<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">spoints</span><span style="color: #c678dd;">(</span>strict_compare_point<span style="color: #c678dd;">)</span>;
  spoints.emplace<span style="color: #c678dd;">(</span>1, 2<span style="color: #c678dd;">)</span>;
  spoints.emplace<span style="color: #c678dd;">(</span>1, 3<span style="color: #c678dd;">)</span>;
  spoints.emplace<span style="color: #c678dd;">(</span>2, 4<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">point</span> : spoints<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; point;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">(1</td>
<td class="org-right">2)</td>
</tr>

<tr>
<td class="org-left">(1</td>
<td class="org-right">3)</td>
</tr>

<tr>
<td class="org-left">(1</td>
<td class="org-right">2)</td>
</tr>

<tr>
<td class="org-left">(1</td>
<td class="org-right">3)</td>
</tr>

<tr>
<td class="org-left">(2</td>
<td class="org-right">4)</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">map</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">m &#20013;&#36827;&#34892;&#20102;&#20540;&#21021;&#22987;&#21270;&#65292;&#22240;&#27492; m &#20013;&#26377;&#20010; std::pair&lt;int, int&gt;(0, 0)</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">map</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span>, <span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">m</span>;
  m<span style="color: #c678dd;">[</span>0<span style="color: #c678dd;">]</span> = 1;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; m.begin<span style="color: #c678dd;">()</span>-&gt;first &lt;&lt; <span style="color: #98be65;">", "</span> &lt;&lt; m.begin<span style="color: #c678dd;">()</span>-&gt;second &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">if</span><span style="color: #c678dd;">(</span>m.find<span style="color: #98be65;">(</span>0<span style="color: #98be65;">)</span> != m.end<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">auto</span>&amp; <span style="color: #dcaeea;">item</span> = *m.find<span style="color: #98be65;">(</span>0<span style="color: #98be65;">)</span>;
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; item.first &lt;&lt; <span style="color: #98be65;">", "</span> &lt;&lt; item.second &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>

<p>
从 <code>multimap</code> 中找出所有与 <code>key</code> 绑定的值
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">map</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">multimap</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::string, <span style="color: #a9a1e1;">std</span>::string<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">mm</span> = <span style="color: #c678dd;">{</span>
    <span style="color: #98be65;">{</span><span style="color: #98be65;">"duck"</span>, <span style="color: #98be65;">"run"</span><span style="color: #98be65;">}</span>,
    <span style="color: #98be65;">{</span><span style="color: #98be65;">"dog"</span>, <span style="color: #98be65;">"run"</span><span style="color: #98be65;">}</span>,
    <span style="color: #98be65;">{</span><span style="color: #98be65;">"duck"</span>, <span style="color: #98be65;">"fly"</span><span style="color: #98be65;">}</span>
  <span style="color: #c678dd;">}</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#31532;&#19968;&#31181;&#26041;&#27861;&#26159;&#25163;&#21160;&#36941;&#21382; map</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"The first method to find duck."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">pos</span> = mm.begin<span style="color: #c678dd;">()</span>;
  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span>pos != mm.end<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">if</span> <span style="color: #98be65;">(</span>pos-&gt;first == <span style="color: #98be65;">"duck"</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"duck can "</span> &lt;&lt; pos-&gt;second &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
    <span style="color: #98be65;">}</span>
    ++pos;
  <span style="color: #c678dd;">}</span>

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#31532;&#20108;&#31181;&#26041;&#27861;&#26159;&#21033;&#29992; find &#21644; count</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"The second method to find duck."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">count</span> = mm.count<span style="color: #c678dd;">(</span><span style="color: #98be65;">"duck"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">entries</span> = mm.find<span style="color: #c678dd;">(</span><span style="color: #98be65;">"duck"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span>count<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"duck can "</span> &lt;&lt; entries-&gt;second &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
    ++entries;
    --count;
  <span style="color: #c678dd;">}</span>

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#31532;&#19977;&#31181;&#26041;&#27861;&#26159;&#21033;&#29992; lower_bound &#21644; upper_bound</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"The third method to find duck."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">beg</span> = mm.lower_bound<span style="color: #98be65;">(</span><span style="color: #98be65;">"duck"</span><span style="color: #98be65;">)</span>, <span style="color: #dcaeea;">end</span> = mm.upper_bound<span style="color: #98be65;">(</span><span style="color: #98be65;">"duck"</span><span style="color: #98be65;">)</span>;
       beg != end; ++beg<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"duck can "</span> &lt;&lt; beg-&gt;second &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #c678dd;">}</span>

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#31532;&#22235;&#31181;&#26041;&#27861;&#26159;&#21033;&#29992; equal_range</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"The forth method to find duck."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">pos</span> = mm.equal_range<span style="color: #98be65;">(</span><span style="color: #98be65;">"duck"</span><span style="color: #98be65;">)</span>;
       pos.first != pos.second; ++pos.first<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"duck can "</span> &lt;&lt; pos.first-&gt;second &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">The</td>
<td class="org-left">first</td>
<td class="org-left">method</td>
<td class="org-left">to</td>
<td class="org-left">find</td>
<td class="org-left">duck.</td>
</tr>

<tr>
<td class="org-left">duck</td>
<td class="org-left">can</td>
<td class="org-left">run</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">duck</td>
<td class="org-left">can</td>
<td class="org-left">fly</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">The</td>
<td class="org-left">second</td>
<td class="org-left">method</td>
<td class="org-left">to</td>
<td class="org-left">find</td>
<td class="org-left">duck.</td>
</tr>

<tr>
<td class="org-left">duck</td>
<td class="org-left">can</td>
<td class="org-left">run</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">duck</td>
<td class="org-left">can</td>
<td class="org-left">fly</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">The</td>
<td class="org-left">third</td>
<td class="org-left">method</td>
<td class="org-left">to</td>
<td class="org-left">find</td>
<td class="org-left">duck.</td>
</tr>

<tr>
<td class="org-left">duck</td>
<td class="org-left">can</td>
<td class="org-left">run</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">duck</td>
<td class="org-left">can</td>
<td class="org-left">fly</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">The</td>
<td class="org-left">forth</td>
<td class="org-left">method</td>
<td class="org-left">to</td>
<td class="org-left">find</td>
<td class="org-left">duck.</td>
</tr>

<tr>
<td class="org-left">duck</td>
<td class="org-left">can</td>
<td class="org-left">run</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">duck</td>
<td class="org-left">can</td>
<td class="org-left">fly</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
将自定义的类型作为 <code>key</code> 时需要定义类型的哈希方法和 <code>==</code> 操作符
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">unordered_map</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">hash_map</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">Person</span> <span style="color: #51afef;">{</span>
  <span style="color: #c678dd;">Person</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">__name</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__age</span><span style="color: #c678dd;">)</span> :
    name<span style="color: #c678dd;">(</span>__name<span style="color: #c678dd;">)</span>, age<span style="color: #c678dd;">(</span>__age<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">name</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">age</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21704;&#24076;&#20989;&#25968;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #c678dd;">hasher</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Person</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">__person</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">std</span>::hash<span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;()(</span>__person.name<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">bool</span> <span style="color: #c678dd;">equal_person</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Person</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">lhs</span>, <span style="color: #ECBE7B;">Person</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> lhs.name == rhs.name;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23450;&#20041;&#31867;&#22411;&#21035;&#21517;&#65292;&#27604;&#19968;&#33324;&#30340; map &#22810;&#20004;&#20010;&#31867;&#22411;</span>
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">person_multimap</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">unordered_map</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Person</span>,
                                             <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span>,
                                             <span style="color: #51afef;">decltype</span><span style="color: #98be65;">(</span>hasher<span style="color: #98be65;">)</span>*,
                                             <span style="color: #51afef;">decltype</span><span style="color: #98be65;">(</span>equal_person<span style="color: #98be65;">)</span>*<span style="color: #c678dd;">&gt;</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23450;&#20041;&#30005;&#35805;&#34180;&#65292;24 &#26159;&#26742;&#30340;&#22823;&#23567;</span>
  <span style="color: #ECBE7B;">person_multimap</span> <span style="color: #dcaeea;">book</span><span style="color: #c678dd;">(</span>24, hasher, equal_person<span style="color: #c678dd;">)</span>;
  book.insert<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #98be65;">(</span>Person<span style="color: #a9a1e1;">(</span><span style="color: #98be65;">"Alisa"</span>, 25<span style="color: #a9a1e1;">)</span>, <span style="color: #98be65;">"123-456-789"</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  book.insert<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #98be65;">(</span>Person<span style="color: #a9a1e1;">(</span><span style="color: #98be65;">"Bob"</span>, 26<span style="color: #a9a1e1;">)</span>, <span style="color: #98be65;">"324-783-192"</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  book.insert<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #98be65;">(</span>Person<span style="color: #a9a1e1;">(</span><span style="color: #98be65;">"Tim"</span>, 23<span style="color: #a9a1e1;">)</span>, <span style="color: #98be65;">"583-125-372"</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Alisa's telephone number is "</span>
            &lt;&lt; book.find<span style="color: #c678dd;">(</span>Person<span style="color: #98be65;">(</span><span style="color: #98be65;">"Alisa"</span>, 25<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>-&gt;second &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Bucket size of key Alisa is "</span>
            &lt;&lt; book.bucket_size<span style="color: #c678dd;">(</span>book.bucket<span style="color: #98be65;">(</span>Person<span style="color: #a9a1e1;">(</span><span style="color: #98be65;">"Alisa"</span>, 25<span style="color: #a9a1e1;">)</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-right">

<col  class="org-left">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">Alisa's</td>
<td class="org-left">telephone</td>
<td class="org-left">number</td>
<td class="org-left">is</td>
<td class="org-right">123-456-789</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Bucket</td>
<td class="org-left">size</td>
<td class="org-left">of</td>
<td class="org-left">key</td>
<td class="org-right">Alisa</td>
<td class="org-left">is</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org52f8a36" class="outline-2">
<h2 id="org52f8a36"><span class="section-number-2">12</span> <code>std::format</code></h2>
<div class="outline-text-2" id="text-12">
<p>
需要等待编译器支持，目前仍需使用 <code>fmt</code> 第三方库
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#38656;&#35201; C++20 &#26631;&#20934;&#25903;&#25345;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">#include &lt;format&gt;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">fmt &#31532;&#19977;&#26041;&#24211;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">fmt/core.h</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #c678dd;">(</span><span style="color: #98be65;">"{1}, {0}."</span>, <span style="color: #98be65;">"world"</span>, <span style="color: #98be65;">"hello"</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4093c64" class="outline-2">
<h2 id="org4093c64"><span class="section-number-2">13</span> <code>range</code> 与 <code>view</code> 视图</h2>
<div class="outline-text-2" id="text-13">
<p>
<code>ranges</code> 功能目前编译器还未实现，需要自己安装 <code>ranges v3</code> 头文件。惰性求值的特性不错，
就是编译太慢了
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">range/v3/action.hpp</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">range/v3/view.hpp</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">range/v3/numeric.hpp</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">range/v3/algorithm.hpp</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">range/v3/iterator.hpp</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">ranges</span>;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">total</span> = <span style="color: #a9a1e1;">ranges</span>::accumulate<span style="color: #c678dd;">(</span>
                               <span style="color: #a9a1e1;">view</span>::ints<span style="color: #98be65;">(</span>1<span style="color: #98be65;">)</span> |
                               <span style="color: #a9a1e1;">view</span>::transform<span style="color: #98be65;">(</span><span style="color: #a9a1e1;">[](</span><span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span><span style="color: #a9a1e1;">)</span> <span style="color: #a9a1e1;">{</span><span style="color: #51afef;">return</span> i * i;<span style="color: #a9a1e1;">}</span><span style="color: #98be65;">)</span> |
                               <span style="color: #a9a1e1;">view</span>::take<span style="color: #98be65;">(</span>100<span style="color: #98be65;">)</span>,
                               0<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; total &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">std::vector&lt;int&gt; ivec{0, 2, 2, 1, 4, 6, 4, 3, 1};</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">std::vector&lt;int&gt; result = ivec | actions::sort | actions::unique;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">ranges::copy(result, ranges::ostream_iterator&lt;int&gt;(std::cout, " "));</span>
<span style="color: #51afef;">}</span>
</pre>
</div>

<p>
一个老派的方式为
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">numeric</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span> = 1; i &lt; 101; ++i<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    ivec.push_back<span style="color: #98be65;">(</span>i<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21069; 10 &#20010;&#24179;&#26041;&#25968;&#30340;&#21644;</span>
  <span style="color: #a9a1e1;">std</span>::transform<span style="color: #c678dd;">(</span>ivec.begin<span style="color: #98be65;">()</span>, ivec.end<span style="color: #98be65;">()</span>,
                 ivec.begin<span style="color: #98be65;">()</span>, <span style="color: #98be65;">[](</span><span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span> <span style="color: #51afef;">return</span> i * i; <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">std</span>::accumulate<span style="color: #c678dd;">(</span>ivec.cbegin<span style="color: #98be65;">()</span>, ivec.cend<span style="color: #98be65;">()</span>, 0<span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<pre class="example">
338350
</pre>


<p>
<code>g++</code> 对 <code>C++20</code> 标准有了部分支持，需要指定 <code>-std=c++20</code>
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">ranges</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">i</span> : <span style="color: #a9a1e1;">views</span>::iota<span style="color: #98be65;">(</span>0, 10<span style="color: #98be65;">)</span>
         | <span style="color: #a9a1e1;">views</span>::filter<span style="color: #98be65;">(</span><span style="color: #a9a1e1;">[](</span><span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span><span style="color: #a9a1e1;">)</span> <span style="color: #a9a1e1;">{</span> <span style="color: #51afef;">return</span> i % 2; <span style="color: #a9a1e1;">}</span><span style="color: #98be65;">)</span>
         | <span style="color: #a9a1e1;">views</span>::transform<span style="color: #98be65;">(</span><span style="color: #a9a1e1;">[](</span><span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">i</span><span style="color: #a9a1e1;">)</span> <span style="color: #a9a1e1;">{</span> <span style="color: #51afef;">return</span> i * i; <span style="color: #a9a1e1;">}</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>
    cout &lt;&lt; i &lt;&lt; <span style="color: #98be65;">" "</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<pre class="example">
1 9 25 49 81
</pre>


<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">ranges</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span> <span style="color: #51afef;">{</span>
<span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">ranges</span> <span style="color: #c678dd;">{</span>

<span style="color: #51afef;">template</span> <span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">input_range</span> <span style="color: #dcaeea;">_Vp</span><span style="color: #98be65;">&gt;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">cycle_view</span> : <span style="color: #51afef;">public</span> <span style="color: #ECBE7B;">view_interface</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">cycle_view</span><span style="color: #a9a1e1;">&lt;</span>_Vp<span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;</span>
<span style="color: #98be65;">{</span>
<span style="color: #51afef;">private</span>:
  <span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">_Sentinel</span>;

  <span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">_Iterator</span>
  <span style="color: #a9a1e1;">{</span>
  <span style="color: #51afef;">private</span>:
    <span style="color: #51afef;">friend</span> <span style="color: #ECBE7B;">_Sentinel</span>;
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">_Vp_iter</span> = <span style="color: #ECBE7B;">iterator_t</span><span style="color: #4db5bd;">&lt;</span>_Vp<span style="color: #4db5bd;">&gt;</span>;

    <span style="color: #ECBE7B;">_Vp_iter</span> <span style="color: #dcaeea;">_M_current</span> = _Vp_iter<span style="color: #4db5bd;">()</span>;
    <span style="color: #ECBE7B;">cycle_view</span>* <span style="color: #dcaeea;">_M_parent</span> = <span style="color: #a9a1e1;">nullptr</span>;
  <span style="color: #51afef;">public</span>:
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">iterator_category</span> = <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">iterator_traits</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp_iter</span><span style="color: #4db5bd;">&gt;</span>::iterator_category;
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">value_type</span> = <span style="color: #ECBE7B;">range_value_t</span><span style="color: #4db5bd;">&lt;</span>_Vp<span style="color: #4db5bd;">&gt;</span>;
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">difference_type</span> = <span style="color: #ECBE7B;">range_difference_t</span><span style="color: #4db5bd;">&lt;</span>_Vp<span style="color: #4db5bd;">&gt;</span>;

    <span style="color: #c678dd;">_Iterator</span><span style="color: #4db5bd;">()</span> = <span style="color: #51afef;">default</span>;

    <span style="color: #51afef;">constexpr</span> <span style="color: #c678dd;">_Iterator</span><span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">cycle_view</span>&amp; <span style="color: #dcaeea;">__parent</span>, <span style="color: #ECBE7B;">_Vp_iter</span> <span style="color: #dcaeea;">__current</span><span style="color: #4db5bd;">)</span>
      : _M_current<span style="color: #4db5bd;">(</span><span style="color: #a9a1e1;">std</span>::move<span style="color: #51afef;">(</span>__current<span style="color: #51afef;">)</span><span style="color: #4db5bd;">)</span>,
        _M_parent<span style="color: #4db5bd;">(</span><span style="color: #a9a1e1;">std</span>::__addressof<span style="color: #51afef;">(</span>__parent<span style="color: #51afef;">)</span><span style="color: #4db5bd;">)</span> <span style="color: #4db5bd;">{}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">range_reference_t</span><span style="color: #4db5bd;">&lt;</span>_Vp<span style="color: #4db5bd;">&gt;</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">*</span><span style="color: #4db5bd;">()</span> <span style="color: #51afef;">const</span>
    <span style="color: #4db5bd;">{</span> <span style="color: #51afef;">return</span> *_M_current; <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">_Vp_iter</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">-&gt;</span><span style="color: #4db5bd;">()</span> <span style="color: #51afef;">const</span>
      <span style="color: #ECBE7B;">requires</span> <span style="color: #a9a1e1;">__detail</span>::<span style="color: #ECBE7B;">__has_arrow</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp_iter</span><span style="color: #4db5bd;">&gt;</span> &amp;&amp; <span style="color: #ECBE7B;">copyable</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp_iter</span><span style="color: #4db5bd;">&gt;</span>
    <span style="color: #4db5bd;">{</span> <span style="color: #51afef;">return</span> _M_current; <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">++</span><span style="color: #4db5bd;">()</span>
    <span style="color: #4db5bd;">{</span>
      ++_M_current;
      <span style="color: #51afef;">if</span><span style="color: #51afef;">(</span>_M_current == <span style="color: #a9a1e1;">ranges</span>::end<span style="color: #c678dd;">(</span>_M_parent-&gt;_M_base<span style="color: #c678dd;">)</span><span style="color: #51afef;">)</span>
        _M_current = <span style="color: #a9a1e1;">ranges</span>::begin<span style="color: #51afef;">(</span>_M_parent-&gt;_M_base<span style="color: #51afef;">)</span>;

      <span style="color: #51afef;">return</span> *<span style="color: #51afef;">this</span>;
    <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">void</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">++</span><span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">int</span><span style="color: #4db5bd;">)</span>
    <span style="color: #4db5bd;">{</span>
      ++*<span style="color: #51afef;">this</span>;
    <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">_Iterator</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">++</span><span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">int</span><span style="color: #4db5bd;">)</span> <span style="color: #ECBE7B;">requires</span> <span style="color: #ECBE7B;">forward_range</span><span style="color: #4db5bd;">&lt;</span>_Vp<span style="color: #4db5bd;">&gt;</span>
    <span style="color: #4db5bd;">{</span>
      <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">__tmp</span> = *<span style="color: #51afef;">this</span>;
      ++*<span style="color: #51afef;">this</span>;
      <span style="color: #51afef;">return</span> __tmp;
    <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">friend</span> <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">bool</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">==</span><span style="color: #4db5bd;">(</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #dcaeea;">__x</span>, <span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #dcaeea;">__y</span><span style="color: #4db5bd;">)</span>
      <span style="color: #ECBE7B;">requires</span> <span style="color: #ECBE7B;">equality_comparable</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp_iter</span><span style="color: #4db5bd;">&gt;</span>
    <span style="color: #4db5bd;">{</span> <span style="color: #51afef;">return</span> __x._M_current == __y._M_current; <span style="color: #4db5bd;">}</span>
  <span style="color: #a9a1e1;">}</span>;

  <span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">_Sentinel</span>
  <span style="color: #a9a1e1;">{</span>
  <span style="color: #51afef;">private</span>:
    <span style="color: #ECBE7B;">sentinel_t</span><span style="color: #4db5bd;">&lt;</span>_Vp<span style="color: #4db5bd;">&gt;</span> <span style="color: #dcaeea;">_M_end</span> = sentinel_t<span style="color: #4db5bd;">&lt;</span>_Vp<span style="color: #4db5bd;">&gt;()</span>;

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">bool</span> <span style="color: #c678dd;">__equal</span><span style="color: #4db5bd;">(</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #dcaeea;">__i</span><span style="color: #4db5bd;">)</span> <span style="color: #51afef;">const</span>
    <span style="color: #4db5bd;">{</span>
      <span style="color: #51afef;">return</span> __i._M_current == _M_end;
    <span style="color: #4db5bd;">}</span>
  <span style="color: #51afef;">public</span>:
    <span style="color: #c678dd;">_Sentinel</span><span style="color: #4db5bd;">()</span> = <span style="color: #51afef;">default</span>;

    <span style="color: #51afef;">constexpr</span> <span style="color: #51afef;">explicit</span> <span style="color: #c678dd;">_Sentinel</span><span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">cycle_view</span>&amp; <span style="color: #dcaeea;">__parent</span><span style="color: #4db5bd;">)</span> :
      _M_end<span style="color: #4db5bd;">(</span><span style="color: #a9a1e1;">ranges</span>::end<span style="color: #51afef;">(</span>__parent._M_base<span style="color: #51afef;">)</span><span style="color: #4db5bd;">)</span> <span style="color: #4db5bd;">{}</span>

    <span style="color: #51afef;">friend</span> <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">bool</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">==</span><span style="color: #4db5bd;">(</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #dcaeea;">__x</span>, <span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Sentinel</span>&amp; <span style="color: #dcaeea;">__y</span><span style="color: #4db5bd;">)</span>
    <span style="color: #4db5bd;">{</span> <span style="color: #51afef;">return</span> __y.__equal<span style="color: #51afef;">(</span>__x<span style="color: #51afef;">)</span>; <span style="color: #4db5bd;">}</span>
  <span style="color: #a9a1e1;">}</span>;

  <span style="color: #ECBE7B;">_Vp</span> <span style="color: #dcaeea;">_M_base</span> = _Vp<span style="color: #a9a1e1;">()</span>;
<span style="color: #51afef;">public</span>:
    <span style="color: #c678dd;">cycle_view</span><span style="color: #a9a1e1;">()</span> = <span style="color: #51afef;">default</span>;

    <span style="color: #51afef;">constexpr</span> <span style="color: #c678dd;">cycle_view</span><span style="color: #a9a1e1;">(</span><span style="color: #ECBE7B;">_Vp</span> <span style="color: #dcaeea;">__base</span><span style="color: #a9a1e1;">)</span>: _M_base<span style="color: #a9a1e1;">(</span><span style="color: #a9a1e1;">std</span>::move<span style="color: #4db5bd;">(</span>__base<span style="color: #4db5bd;">)</span><span style="color: #a9a1e1;">)</span> <span style="color: #a9a1e1;">{}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">_Iterator</span> <span style="color: #c678dd;">begin</span><span style="color: #a9a1e1;">()</span>
    <span style="color: #a9a1e1;">{</span>
        <span style="color: #51afef;">return</span> <span style="color: #4db5bd;">{</span>*<span style="color: #51afef;">this</span>, <span style="color: #a9a1e1;">ranges</span>::begin<span style="color: #51afef;">(</span>_M_base<span style="color: #51afef;">)</span><span style="color: #4db5bd;">}</span>;
    <span style="color: #a9a1e1;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #51afef;">auto</span> <span style="color: #c678dd;">end</span><span style="color: #a9a1e1;">()</span>
    <span style="color: #a9a1e1;">{</span>
      <span style="color: #51afef;">if</span> <span style="color: #51afef;">constexpr</span> <span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">common_range</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">_Vp</span><span style="color: #51afef;">&gt;</span><span style="color: #4db5bd;">)</span>
        <span style="color: #51afef;">return</span> _Iterator<span style="color: #4db5bd;">{</span>*<span style="color: #51afef;">this</span>, <span style="color: #a9a1e1;">ranges</span>::end<span style="color: #51afef;">(</span>_M_base<span style="color: #51afef;">)</span><span style="color: #4db5bd;">}</span>;
      <span style="color: #51afef;">else</span>
        <span style="color: #51afef;">return</span> _Sentinel<span style="color: #4db5bd;">{</span>*<span style="color: #51afef;">this</span><span style="color: #4db5bd;">}</span>;
    <span style="color: #a9a1e1;">}</span>
<span style="color: #98be65;">}</span>;

<span style="color: #51afef;">template</span> <span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">input_range</span> <span style="color: #dcaeea;">_Range</span><span style="color: #98be65;">&gt;</span>
<span style="color: #c678dd;">cycle_view</span><span style="color: #98be65;">(</span><span style="color: #ECBE7B;">_Range</span> &amp;&amp;<span style="color: #98be65;">)</span> -&gt; <span style="color: #ECBE7B;">cycle_view</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">views</span>::<span style="color: #ECBE7B;">all_t</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #ECBE7B;">_Range</span><span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;</span>;

<span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">views</span> <span style="color: #98be65;">{</span>
  <span style="color: #51afef;">inline</span> <span style="color: #51afef;">constexpr</span> <span style="color: #a9a1e1;">__adaptor</span>::<span style="color: #ECBE7B;">_RangeAdaptorClosure</span> <span style="color: #dcaeea;">cycle</span>
  = <span style="color: #a9a1e1;">[]</span> <span style="color: #a9a1e1;">&lt;</span><span style="color: #ECBE7B;">viewable_range</span> <span style="color: #dcaeea;">_Range</span><span style="color: #a9a1e1;">&gt;</span> <span style="color: #a9a1e1;">(</span><span style="color: #ECBE7B;">_Range</span>&amp;&amp; <span style="color: #dcaeea;">__r</span><span style="color: #a9a1e1;">)</span>
  <span style="color: #a9a1e1;">{</span>
    <span style="color: #51afef;">return</span> cycle_view <span style="color: #4db5bd;">{</span> <span style="color: #a9a1e1;">std</span>::forward<span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">_Range</span><span style="color: #51afef;">&gt;(</span>__r<span style="color: #51afef;">)</span> <span style="color: #4db5bd;">}</span>;
  <span style="color: #a9a1e1;">}</span>;
<span style="color: #98be65;">}</span> <span style="color: #5B6268;">// </span><span style="color: #5B6268;">namespace views</span>

<span style="color: #51afef;">template</span> <span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">input_range</span> <span style="color: #dcaeea;">_Vp1</span>, <span style="color: #ECBE7B;">input_range</span> <span style="color: #dcaeea;">_Vp2</span><span style="color: #98be65;">&gt;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">zip_view</span> : <span style="color: #51afef;">public</span> <span style="color: #ECBE7B;">view_interface</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">zip_view</span><span style="color: #a9a1e1;">&lt;</span>_Vp1, _Vp2<span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;</span>
<span style="color: #98be65;">{</span>
<span style="color: #51afef;">private</span>:
  <span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">_Sentinel</span>;

  <span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">_Iterator</span>
  <span style="color: #a9a1e1;">{</span>
  <span style="color: #51afef;">private</span>:
    <span style="color: #51afef;">friend</span> <span style="color: #ECBE7B;">zip_view</span>;
    <span style="color: #51afef;">friend</span> <span style="color: #ECBE7B;">_Sentinel</span>;
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">_Vp1_iter</span> = <span style="color: #ECBE7B;">iterator_t</span><span style="color: #4db5bd;">&lt;</span>_Vp1<span style="color: #4db5bd;">&gt;</span>;
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">_Vp2_iter</span> = <span style="color: #ECBE7B;">iterator_t</span><span style="color: #4db5bd;">&lt;</span>_Vp2<span style="color: #4db5bd;">&gt;</span>;

    <span style="color: #ECBE7B;">_Vp1_iter</span> <span style="color: #dcaeea;">_M_current1</span> = _Vp1_iter<span style="color: #4db5bd;">()</span>;
    <span style="color: #ECBE7B;">_Vp2_iter</span> <span style="color: #dcaeea;">_M_current2</span> = _Vp2_iter<span style="color: #4db5bd;">()</span>;
    <span style="color: #ECBE7B;">zip_view</span>* <span style="color: #dcaeea;">_M_parent</span> = <span style="color: #a9a1e1;">nullptr</span>;
  <span style="color: #51afef;">public</span>:
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">iterator_category</span> = <span style="color: #51afef;">typename</span> <span style="color: #a9a1e1;">iterator_traits</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp1_iter</span><span style="color: #4db5bd;">&gt;</span>::iterator_category;
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">value_type</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">pair</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">range_value_t</span><span style="color: #51afef;">&lt;</span>_Vp1<span style="color: #51afef;">&gt;</span>, <span style="color: #ECBE7B;">range_value_t</span><span style="color: #51afef;">&lt;</span>_Vp2<span style="color: #51afef;">&gt;</span><span style="color: #4db5bd;">&gt;</span>;
    <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">difference_type</span> = <span style="color: #ECBE7B;">range_difference_t</span><span style="color: #4db5bd;">&lt;</span>_Vp1<span style="color: #4db5bd;">&gt;</span>;

    <span style="color: #c678dd;">_Iterator</span><span style="color: #4db5bd;">()</span> = <span style="color: #51afef;">default</span>;

    <span style="color: #51afef;">constexpr</span> <span style="color: #c678dd;">_Iterator</span><span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">zip_view</span>&amp; <span style="color: #dcaeea;">__parent</span>,
      <span style="color: #ECBE7B;">_Vp1_iter</span> <span style="color: #dcaeea;">__current1</span>, <span style="color: #ECBE7B;">_Vp2_iter</span> <span style="color: #dcaeea;">__current2</span><span style="color: #4db5bd;">)</span> :
      _M_current1<span style="color: #4db5bd;">(</span><span style="color: #a9a1e1;">std</span>::move<span style="color: #51afef;">(</span>__current1<span style="color: #51afef;">)</span><span style="color: #4db5bd;">)</span>,
      _M_current2<span style="color: #4db5bd;">(</span><span style="color: #a9a1e1;">std</span>::move<span style="color: #51afef;">(</span>__current2<span style="color: #51afef;">)</span><span style="color: #4db5bd;">)</span>,
      _M_parent<span style="color: #4db5bd;">(</span><span style="color: #a9a1e1;">std</span>::__addressof<span style="color: #51afef;">(</span>__parent<span style="color: #51afef;">)</span><span style="color: #4db5bd;">)</span> <span style="color: #4db5bd;">{}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">pair</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">range_reference_t</span><span style="color: #51afef;">&lt;</span>_Vp1<span style="color: #51afef;">&gt;</span>, <span style="color: #ECBE7B;">range_reference_t</span><span style="color: #51afef;">&lt;</span>_Vp2<span style="color: #51afef;">&gt;</span><span style="color: #4db5bd;">&gt;</span>
    <span style="color: #51afef;">operator</span><span style="color: #c678dd;">*</span><span style="color: #4db5bd;">()</span> <span style="color: #51afef;">const</span>
    <span style="color: #4db5bd;">{</span> <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ref</span><span style="color: #c678dd;">(</span>*<span style="color: #dcaeea;">_M_current1</span><span style="color: #c678dd;">)</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ref</span><span style="color: #c678dd;">(</span>*<span style="color: #dcaeea;">_M_current2</span><span style="color: #c678dd;">)</span><span style="color: #51afef;">)</span>; <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">pair</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp1_iter</span>, <span style="color: #ECBE7B;">_Vp2_iter</span><span style="color: #4db5bd;">&gt;</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">-&gt;</span><span style="color: #4db5bd;">()</span> <span style="color: #51afef;">const</span>
      <span style="color: #ECBE7B;">requires</span> <span style="color: #a9a1e1;">__detail</span>::<span style="color: #ECBE7B;">__has_arrow</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp1_iter</span><span style="color: #4db5bd;">&gt;</span> &amp;&amp;
          <span style="color: #a9a1e1;">__detail</span>::<span style="color: #ECBE7B;">__has_arrow</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp2_iter</span><span style="color: #4db5bd;">&gt;</span>
    <span style="color: #4db5bd;">{</span> <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #51afef;">(</span>_M_current1, _M_current2<span style="color: #51afef;">)</span>; <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">++</span><span style="color: #4db5bd;">()</span>
    <span style="color: #4db5bd;">{</span>
      ++_M_current1;
      ++_M_current2;
      <span style="color: #5B6268;">//</span><span style="color: #5B6268;">if(_M_current1 == ranges::end(_M_parent-&gt;_M_base1)</span>
      <span style="color: #5B6268;">//    </span><span style="color: #5B6268;">|| _M_current2 == ranges::end(_M_parent-&gt;_M_base2))</span>
      <span style="color: #51afef;">return</span> *<span style="color: #51afef;">this</span>;
    <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">void</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">++</span><span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">int</span><span style="color: #4db5bd;">)</span>
    <span style="color: #4db5bd;">{</span> ++*<span style="color: #51afef;">this</span>; <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">_Iterator</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">++</span><span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">int</span><span style="color: #4db5bd;">)</span> <span style="color: #ECBE7B;">requires</span> <span style="color: #ECBE7B;">forward_range</span><span style="color: #4db5bd;">&lt;</span>_Vp1<span style="color: #4db5bd;">&gt;</span> &amp;&amp; <span style="color: #ECBE7B;">forward_range</span><span style="color: #4db5bd;">&lt;</span>_Vp2<span style="color: #4db5bd;">&gt;</span>
    <span style="color: #4db5bd;">{</span>
      <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">__tmp</span> = *<span style="color: #51afef;">this</span>;
      ++*<span style="color: #51afef;">this</span>;
      <span style="color: #51afef;">return</span> __tmp;
    <span style="color: #4db5bd;">}</span>

    <span style="color: #51afef;">friend</span> <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">bool</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">==</span><span style="color: #4db5bd;">(</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #dcaeea;">__x</span>, <span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #dcaeea;">__y</span><span style="color: #4db5bd;">)</span>
      <span style="color: #ECBE7B;">requires</span> <span style="color: #ECBE7B;">equality_comparable</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp1_iter</span><span style="color: #4db5bd;">&gt;</span> &amp;&amp; <span style="color: #ECBE7B;">equality_comparable</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">_Vp2_iter</span><span style="color: #4db5bd;">&gt;</span>
    <span style="color: #4db5bd;">{</span> <span style="color: #51afef;">return</span> __x._M_current1 == __y._M_current1 &amp;&amp; __x._M_current2 == __y._M_current2; <span style="color: #4db5bd;">}</span>
  <span style="color: #a9a1e1;">}</span>;

  <span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">_Sentinel</span>
  <span style="color: #a9a1e1;">{</span>
  <span style="color: #51afef;">private</span>:
    <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">pair</span><span style="color: #4db5bd;">&lt;</span><span style="color: #ECBE7B;">sentinel_t</span><span style="color: #51afef;">&lt;</span>_Vp1<span style="color: #51afef;">&gt;</span>, <span style="color: #ECBE7B;">sentinel_t</span><span style="color: #51afef;">&lt;</span>_Vp2<span style="color: #51afef;">&gt;</span><span style="color: #4db5bd;">&gt;</span> <span style="color: #dcaeea;">_M_end</span> =
      <span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #4db5bd;">(</span>sentinel_t<span style="color: #51afef;">&lt;</span>_Vp1<span style="color: #51afef;">&gt;()</span>, sentinel_t<span style="color: #51afef;">&lt;</span>_Vp2<span style="color: #51afef;">&gt;()</span><span style="color: #4db5bd;">)</span>;

    <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">bool</span> <span style="color: #c678dd;">__equal</span><span style="color: #4db5bd;">(</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #dcaeea;">__i</span><span style="color: #4db5bd;">)</span> <span style="color: #51afef;">const</span>
    <span style="color: #4db5bd;">{</span>
      <span style="color: #51afef;">return</span> __i._M_current1 == _M_end.first || __i._M_current2 == _M_end.second;
    <span style="color: #4db5bd;">}</span>
  <span style="color: #51afef;">public</span>:
    <span style="color: #c678dd;">_Sentinel</span><span style="color: #4db5bd;">()</span> = <span style="color: #51afef;">default</span>;

    <span style="color: #51afef;">constexpr</span> <span style="color: #51afef;">explicit</span> <span style="color: #c678dd;">_Sentinel</span><span style="color: #4db5bd;">(</span><span style="color: #ECBE7B;">zip_view</span>&amp; <span style="color: #dcaeea;">__parent</span><span style="color: #4db5bd;">)</span>: _M_end<span style="color: #4db5bd;">(</span><span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #51afef;">(</span>
      <span style="color: #a9a1e1;">ranges</span>::end<span style="color: #c678dd;">(</span>__parent._M_base1<span style="color: #c678dd;">)</span>, <span style="color: #a9a1e1;">ranges</span>::end<span style="color: #c678dd;">(</span>__parent._M_base2<span style="color: #c678dd;">)</span><span style="color: #51afef;">)</span><span style="color: #4db5bd;">)</span> <span style="color: #4db5bd;">{}</span>

    <span style="color: #51afef;">friend</span> <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">bool</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">==</span><span style="color: #4db5bd;">(</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Iterator</span>&amp; <span style="color: #dcaeea;">__x</span>, <span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">_Sentinel</span>&amp; <span style="color: #dcaeea;">__y</span><span style="color: #4db5bd;">)</span>
    <span style="color: #4db5bd;">{</span> <span style="color: #51afef;">return</span> __y.__equal<span style="color: #51afef;">(</span>__x<span style="color: #51afef;">)</span>; <span style="color: #4db5bd;">}</span>
  <span style="color: #a9a1e1;">}</span>;

  <span style="color: #ECBE7B;">_Vp1</span> <span style="color: #dcaeea;">_M_base1</span> = _Vp1<span style="color: #a9a1e1;">()</span>;
  <span style="color: #ECBE7B;">_Vp2</span> <span style="color: #dcaeea;">_M_base2</span> = _Vp2<span style="color: #a9a1e1;">()</span>;
<span style="color: #51afef;">public</span>:
  <span style="color: #c678dd;">zip_view</span><span style="color: #a9a1e1;">()</span> = <span style="color: #51afef;">default</span>;

  <span style="color: #51afef;">constexpr</span> <span style="color: #c678dd;">zip_view</span><span style="color: #a9a1e1;">(</span><span style="color: #ECBE7B;">_Vp1</span> <span style="color: #dcaeea;">__base1</span>, <span style="color: #ECBE7B;">_Vp2</span> <span style="color: #dcaeea;">__base2</span><span style="color: #a9a1e1;">)</span>: _M_base1<span style="color: #a9a1e1;">(</span><span style="color: #a9a1e1;">std</span>::move<span style="color: #4db5bd;">(</span>__base1<span style="color: #4db5bd;">)</span><span style="color: #a9a1e1;">)</span>,
    _M_base2<span style="color: #a9a1e1;">(</span><span style="color: #a9a1e1;">std</span>::move<span style="color: #4db5bd;">(</span>__base2<span style="color: #4db5bd;">)</span><span style="color: #a9a1e1;">)</span> <span style="color: #a9a1e1;">{}</span>

  <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">_Iterator</span> <span style="color: #c678dd;">begin</span><span style="color: #a9a1e1;">()</span>
  <span style="color: #a9a1e1;">{</span> <span style="color: #51afef;">return</span> <span style="color: #4db5bd;">{</span>*<span style="color: #51afef;">this</span>, <span style="color: #a9a1e1;">ranges</span>::begin<span style="color: #51afef;">(</span>_M_base1<span style="color: #51afef;">)</span>, <span style="color: #a9a1e1;">ranges</span>::begin<span style="color: #51afef;">(</span>_M_base2<span style="color: #51afef;">)</span><span style="color: #4db5bd;">}</span>; <span style="color: #a9a1e1;">}</span>

  <span style="color: #51afef;">constexpr</span> <span style="color: #51afef;">auto</span> <span style="color: #c678dd;">end</span><span style="color: #a9a1e1;">()</span>
  <span style="color: #a9a1e1;">{</span>
    <span style="color: #5B6268;">//</span><span style="color: #5B6268;">if constexpr (common_range&lt;_Vp1&gt; &amp;&amp; common_range&lt;_Vp2&gt;)</span>
    <span style="color: #5B6268;">//  </span><span style="color: #5B6268;">return _Iterator{*this, ranges::end(_M_base1), ranges::end(_M_base2)};</span>
    <span style="color: #5B6268;">//</span><span style="color: #5B6268;">else</span>
      <span style="color: #51afef;">return</span> _Sentinel<span style="color: #4db5bd;">{</span>*<span style="color: #51afef;">this</span><span style="color: #4db5bd;">}</span>;
  <span style="color: #a9a1e1;">}</span>
<span style="color: #98be65;">}</span>;


<span style="color: #51afef;">template</span> <span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">input_range</span> <span style="color: #dcaeea;">_Vp1</span>, <span style="color: #ECBE7B;">input_range</span> <span style="color: #dcaeea;">_Vp2</span><span style="color: #98be65;">&gt;</span>
<span style="color: #51afef;">inline</span> <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">bool</span> <span style="color: #ECBE7B;">enable_borrowed_range</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">zip_view</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #ECBE7B;">_Vp1</span>, <span style="color: #ECBE7B;">_Vp2</span><span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;</span> = <span style="color: #a9a1e1;">true</span>;

<span style="color: #51afef;">template</span> <span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">input_range</span> <span style="color: #dcaeea;">_Range1</span>, <span style="color: #ECBE7B;">input_range</span> <span style="color: #dcaeea;">_Range2</span><span style="color: #98be65;">&gt;</span>
<span style="color: #c678dd;">zip_view</span><span style="color: #98be65;">(</span><span style="color: #ECBE7B;">_Range1</span>&amp;&amp;, <span style="color: #ECBE7B;">_Range2</span>&amp;&amp;<span style="color: #98be65;">)</span> -&gt; <span style="color: #ECBE7B;">zip_view</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">views</span>::<span style="color: #ECBE7B;">all_t</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #ECBE7B;">_Range1</span><span style="color: #a9a1e1;">&gt;</span>, <span style="color: #a9a1e1;">views</span>::<span style="color: #ECBE7B;">all_t</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #ECBE7B;">_Range2</span><span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;</span>;

<span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">views</span> <span style="color: #98be65;">{</span>
  <span style="color: #51afef;">inline</span> <span style="color: #51afef;">constexpr</span> <span style="color: #a9a1e1;">__adaptor</span>::<span style="color: #ECBE7B;">_RangeAdaptor</span> <span style="color: #dcaeea;">zip</span>
  = <span style="color: #a9a1e1;">[]</span> <span style="color: #a9a1e1;">&lt;</span><span style="color: #ECBE7B;">viewable_range</span> <span style="color: #dcaeea;">_Range1</span>, <span style="color: #ECBE7B;">viewable_range</span> <span style="color: #dcaeea;">_Range2</span><span style="color: #a9a1e1;">&gt;</span> <span style="color: #a9a1e1;">(</span><span style="color: #ECBE7B;">_Range1</span>&amp;&amp; <span style="color: #dcaeea;">__r1</span>, <span style="color: #dcaeea;">_Range2</span>&amp;&amp; __r2<span style="color: #a9a1e1;">)</span>
  <span style="color: #a9a1e1;">{</span>
    <span style="color: #51afef;">return</span> zip_view <span style="color: #4db5bd;">{</span> <span style="color: #a9a1e1;">std</span>::forward<span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">_Range1</span><span style="color: #51afef;">&gt;(</span>__r1<span style="color: #51afef;">)</span>, <span style="color: #a9a1e1;">std</span>::forward<span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">_Range2</span><span style="color: #51afef;">&gt;(</span>__r2<span style="color: #51afef;">)</span> <span style="color: #4db5bd;">}</span>;
  <span style="color: #a9a1e1;">}</span>;
<span style="color: #98be65;">}</span> <span style="color: #5B6268;">// </span><span style="color: #5B6268;">namespace views</span>

<span style="color: #c678dd;">}</span> <span style="color: #5B6268;">// </span><span style="color: #5B6268;">namespace ranges</span>
<span style="color: #51afef;">}</span> <span style="color: #5B6268;">// </span><span style="color: #5B6268;">mamespace std</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>;

<span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">vs</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">ranges</span>::views;
<span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">rs</span> = <span style="color: #a9a1e1;">std</span>::ranges;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">vector</span> <span style="color: #dcaeea;">v1</span> <span style="color: #c678dd;">{</span><span style="color: #98be65;">"&#30002;"</span>, <span style="color: #98be65;">"&#20057;"</span>, <span style="color: #98be65;">"&#19993;"</span>, <span style="color: #98be65;">"&#19969;"</span>, <span style="color: #98be65;">"&#25098;"</span>, <span style="color: #98be65;">"&#24049;"</span>, <span style="color: #98be65;">"&#24218;"</span>, <span style="color: #98be65;">"&#36763;"</span>, <span style="color: #98be65;">"&#22764;"</span>, <span style="color: #98be65;">"&#30328;"</span><span style="color: #c678dd;">}</span>;
  <span style="color: #ECBE7B;">vector</span> <span style="color: #dcaeea;">v2</span> <span style="color: #c678dd;">{</span><span style="color: #98be65;">"&#23376;"</span>, <span style="color: #98be65;">"&#19985;"</span>, <span style="color: #98be65;">"&#23493;"</span>, <span style="color: #98be65;">"&#21359;"</span>, <span style="color: #98be65;">"&#36784;"</span>, <span style="color: #98be65;">"&#24051;"</span>, <span style="color: #98be65;">"&#21320;"</span>, <span style="color: #98be65;">"&#26410;"</span>, <span style="color: #98be65;">"&#30003;"</span>, <span style="color: #98be65;">"&#37193;"</span>, <span style="color: #98be65;">"&#25100;"</span>, <span style="color: #98be65;">"&#20133;"</span><span style="color: #c678dd;">}</span>;

  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">a</span> = v1 | <span style="color: #a9a1e1;">vs</span>::cycle;
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">b</span> = v2 | <span style="color: #a9a1e1;">vs</span>::cycle;
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">c</span> = <span style="color: #a9a1e1;">vs</span>::zip<span style="color: #c678dd;">(</span>a, b<span style="color: #c678dd;">)</span> | <span style="color: #a9a1e1;">vs</span>::take<span style="color: #c678dd;">(</span>60<span style="color: #c678dd;">)</span>;

  <span style="color: #51afef;">for</span><span style="color: #c678dd;">(</span><span style="color: #51afef;">auto</span>&amp;&amp; <span style="color: #98be65;">[</span><span style="color: #a9a1e1;">x</span>, <span style="color: #a9a1e1;">y</span><span style="color: #98be65;">]</span>: c<span style="color: #c678dd;">)</span>
    cout&lt;&lt;x&lt;&lt;y&lt;&lt;<span style="color: #98be65;">" "</span>;
  cout&lt;&lt;<span style="color: #98be65;">"\n"</span>;

  <span style="color: #51afef;">return</span> 0;
<span style="color: #51afef;">}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org505a6c3" class="outline-2">
<h2 id="org505a6c3"><span class="section-number-2">14</span> 动态内存</h2>
<div class="outline-text-2" id="text-14">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">fmt/core.h</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">{</span>
  <span style="color: #c678dd;">Point</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">__x</span>, <span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">__y</span><span style="color: #c678dd;">)</span> : x<span style="color: #c678dd;">(</span>__x<span style="color: #c678dd;">)</span>, y<span style="color: #c678dd;">(</span>__y<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #98be65;">(</span><span style="color: #98be65;">"Pointer({0}, {1}) is constructed.\n"</span>, x, y<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
  ~<span style="color: #c678dd;">Point</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #98be65;">(</span><span style="color: #98be65;">"Pointer({0}, {1}) is deconstructed.\n"</span>, x, y<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">friend</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">Point</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">p</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #98be65;">(</span><span style="color: #98be65;">"Pointer({0}, {1})"</span>, p.x, p.y<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">x</span> = 0.0l;
  <span style="color: #ECBE7B;">double</span> <span style="color: #dcaeea;">y</span> = 0.0l;
<span style="color: #51afef;">}</span>;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Make shared pointer p."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Point</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">p</span> = <span style="color: #a9a1e1;">std</span>::make_shared<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Point</span><span style="color: #c678dd;">&gt;(</span>1.0, 2.0<span style="color: #c678dd;">)</span>;

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Copy shared pointer q from p."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Point</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">q</span><span style="color: #c678dd;">(</span>p<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *q &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #c678dd;">(</span><span style="color: #98be65;">" has {0} references."</span>, q.use_count<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>
            &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Let p point to a new Point."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  p.reset<span style="color: #c678dd;">(</span><span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">Point</span><span style="color: #98be65;">(</span>3.0, 4.0<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Construct a point with no name assigned."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::make_shared<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Point</span><span style="color: #c678dd;">&gt;(</span>5.0, 6.0<span style="color: #c678dd;">)</span>;

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Now all Points will be deconstructed."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<p>
利用 <code>shared_ptr</code> 实现对象共享底层数据
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">StrBlob &#30340;&#20195;&#29702;&#25351;&#38024;&#31867;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">StrBlobProxy</span>;
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">ConstStrBlobProxy</span>;

<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">StrBlob</span> <span style="color: #51afef;">{</span>
<span style="color: #51afef;">public</span>:
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21451;&#20803;</span>
  <span style="color: #51afef;">friend</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span> <span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">StrBlob</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">friend</span> <span style="color: #ECBE7B;">StrBlobProxy</span>;
  <span style="color: #51afef;">friend</span> <span style="color: #ECBE7B;">ConstStrBlobProxy</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#31867;&#22411;&#21035;&#21517;</span>
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">size_type</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::string<span style="color: #c678dd;">&gt;</span>::size_type;
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">iterator</span> = StrBlobProxy;
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">const_iterator</span> = ConstStrBlobProxy;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26500;&#36896;&#20989;&#25968;</span>
  <span style="color: #c678dd;">StrBlob</span><span style="color: #c678dd;">()</span> : data<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::make_shared<span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #a9a1e1;">std</span>::string<span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;()</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
  <span style="color: #c678dd;">StrBlob</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">initializer_list</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::string<span style="color: #98be65;">&gt;</span> <span style="color: #dcaeea;">il</span><span style="color: #c678dd;">)</span> :
    data<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::make_shared<span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #a9a1e1;">std</span>::string<span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;(</span>il<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>

  <span style="color: #ECBE7B;">size_type</span> <span style="color: #c678dd;">size</span><span style="color: #c678dd;">()</span> <span style="color: #51afef;">const</span> <span style="color: #c678dd;">{</span> <span style="color: #51afef;">return</span> data-&gt;size<span style="color: #98be65;">()</span>; <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">bool</span> <span style="color: #c678dd;">empty</span><span style="color: #c678dd;">()</span> <span style="color: #51afef;">const</span> <span style="color: #c678dd;">{</span> <span style="color: #51afef;">return</span> data-&gt;empty<span style="color: #98be65;">()</span>; <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">push_back</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">s</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> data-&gt;push_back<span style="color: #98be65;">(</span>s<span style="color: #98be65;">)</span>; <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">pop_back</span><span style="color: #c678dd;">()</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span>&amp; <span style="color: #c678dd;">front</span><span style="color: #c678dd;">()</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span>&amp; <span style="color: #c678dd;">back</span><span style="color: #c678dd;">()</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #c678dd;">front</span><span style="color: #c678dd;">()</span> <span style="color: #51afef;">const</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #c678dd;">back</span><span style="color: #c678dd;">()</span> <span style="color: #51afef;">const</span>;
  <span style="color: #ECBE7B;">iterator</span> <span style="color: #c678dd;">begin</span><span style="color: #c678dd;">()</span>;
  <span style="color: #ECBE7B;">iterator</span> <span style="color: #c678dd;">end</span><span style="color: #c678dd;">()</span>;
  <span style="color: #ECBE7B;">const_iterator</span> <span style="color: #c678dd;">begin</span><span style="color: #c678dd;">()</span> <span style="color: #51afef;">const</span>;
  <span style="color: #ECBE7B;">const_iterator</span> <span style="color: #c678dd;">end</span><span style="color: #c678dd;">()</span> <span style="color: #51afef;">const</span>;
<span style="color: #51afef;">private</span>:
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">data</span>;
  <span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">check</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">size_type</span> <span style="color: #dcaeea;">i</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">msg</span><span style="color: #c678dd;">)</span> <span style="color: #51afef;">const</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20195;&#29702;&#25351;&#38024;&#31867;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #51afef;">{</span>
<span style="color: #51afef;">public</span>:
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26500;&#36896;&#20989;&#25968;</span>
  <span style="color: #c678dd;">StrBlobProxy</span><span style="color: #c678dd;">()</span> : curr<span style="color: #c678dd;">(</span>0<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
  <span style="color: #c678dd;">StrBlobProxy</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span> :
    wptr<span style="color: #c678dd;">(</span>rhs.wptr.lock<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>, curr<span style="color: #c678dd;">(</span>rhs.curr<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
  <span style="color: #c678dd;">StrBlobProxy</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">StrBlob</span>&amp; <span style="color: #dcaeea;">__str_blob</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">__index</span> = 0<span style="color: #c678dd;">)</span> :
    wptr<span style="color: #c678dd;">(</span>__str_blob.data<span style="color: #c678dd;">)</span>, curr<span style="color: #c678dd;">(</span>__index<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
  <span style="color: #c678dd;">StrBlobProxy</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">StrBlob</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">__str_blob</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">__index</span> = 0<span style="color: #c678dd;">)</span> :
    wptr<span style="color: #c678dd;">(</span>__str_blob.data<span style="color: #c678dd;">)</span>, curr<span style="color: #c678dd;">(</span>__index<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36816;&#31639;&#31526;&#37325;&#36733;</span>
  <span style="color: #ECBE7B;">StrBlobProxy</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">++</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    ++curr;
    <span style="color: #51afef;">return</span> *<span style="color: #51afef;">this</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">++</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #dcaeea;">tmp</span><span style="color: #98be65;">(</span>*<span style="color: #51afef;">this</span><span style="color: #98be65;">)</span>;
    ++curr;
    <span style="color: #51afef;">return</span> tmp;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">StrBlobProxy</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">--</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    --curr;
    <span style="color: #51afef;">return</span> *<span style="color: #51afef;">this</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">--</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #dcaeea;">tmp</span><span style="color: #98be65;">(</span>*<span style="color: #51afef;">this</span><span style="color: #98be65;">)</span>;
    --curr;
    <span style="color: #51afef;">return</span> tmp;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">+</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">offset</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #dcaeea;">tmp</span><span style="color: #98be65;">(</span>*<span style="color: #51afef;">this</span><span style="color: #98be65;">)</span>;
    tmp.curr += offset;
    <span style="color: #51afef;">return</span> tmp;
  <span style="color: #c678dd;">}</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">*</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">if</span> <span style="color: #98be65;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #4db5bd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #4db5bd;">&gt;</span><span style="color: #a9a1e1;">&gt;</span> <span style="color: #dcaeea;">sptr</span>; <span style="color: #a9a1e1;">(</span>sptr = wptr.lock<span style="color: #4db5bd;">()</span><span style="color: #a9a1e1;">)</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">(</span>*sptr<span style="color: #a9a1e1;">)[</span>curr<span style="color: #a9a1e1;">]</span>;
    <span style="color: #98be65;">}</span> <span style="color: #51afef;">else</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">throw</span>  <span style="color: #a9a1e1;">std</span>::runtime_error<span style="color: #a9a1e1;">(</span><span style="color: #98be65;">"Unbound StrBlob pointer"</span><span style="color: #a9a1e1;">)</span>;
    <span style="color: #98be65;">}</span>
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">bool</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">==</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> curr == rhs.curr;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">bool</span> <span style="color: #51afef;">operator</span><span style="color: #c678dd;">!=</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">return</span> curr != rhs.curr;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">protected</span>:
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span>
  <span style="color: #c678dd;">check</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span> &amp;<span style="color: #c678dd;">)</span> <span style="color: #51afef;">const</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">weak_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">wptr</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">curr</span>;     <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22312;&#25968;&#32452;&#20013;&#30340;&#24403;&#21069;&#20301;&#32622;</span>
<span style="color: #51afef;">}</span>;

<span style="color: #5B6268;">/// </span><span style="color: #5B6268;">&#20174; StrBlobProxy &#27966;&#29983;&#20986;&#24120;&#37327;&#25351;&#38024;&#31867;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">ConstStrBlobProxy</span> : <span style="color: #51afef;">public</span> <span style="color: #ECBE7B;">StrBlobProxy</span> <span style="color: #51afef;">{</span>
<span style="color: #51afef;">public</span>:
  <span style="color: #51afef;">using</span> <span style="color: #a9a1e1;">StrBlobProxy</span>::StrBlobProxy;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">*</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    <span style="color: #51afef;">if</span> <span style="color: #98be65;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #4db5bd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #4db5bd;">&gt;</span> <span style="color: #51afef;">const</span><span style="color: #a9a1e1;">&gt;</span> <span style="color: #dcaeea;">sptr</span>; <span style="color: #a9a1e1;">(</span>sptr = wptr.lock<span style="color: #4db5bd;">()</span><span style="color: #a9a1e1;">)</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">(</span>*sptr<span style="color: #a9a1e1;">)[</span>curr<span style="color: #a9a1e1;">]</span>;
    <span style="color: #98be65;">}</span> <span style="color: #51afef;">else</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">throw</span>  <span style="color: #a9a1e1;">std</span>::runtime_error<span style="color: #a9a1e1;">(</span><span style="color: #98be65;">"Unbound StrBlob pointer"</span><span style="color: #a9a1e1;">)</span>;
    <span style="color: #98be65;">}</span>
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">private</span>:
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">weak_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;</span> <span style="color: #51afef;">const</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">wptr</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #ECBE7B;">void</span> <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">check</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">size_type</span> <span style="color: #dcaeea;">i</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">msg</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">const</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>i &gt;= data-&gt;size<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>
    <span style="color: #51afef;">throw</span> <span style="color: #a9a1e1;">std</span>::out_of_range<span style="color: #c678dd;">(</span>msg<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span>&amp; <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">front</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  check<span style="color: #c678dd;">(</span>0, <span style="color: #98be65;">"front on empty StrBlob."</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> data-&gt;front<span style="color: #c678dd;">()</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span>&amp; <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">back</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  check<span style="color: #c678dd;">(</span>0, <span style="color: #98be65;">"back on empty StrBlob."</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> data-&gt;back<span style="color: #c678dd;">()</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">front</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">const</span>
<span style="color: #51afef;">{</span>
  check<span style="color: #c678dd;">(</span>0, <span style="color: #98be65;">"front on empty StrBlob."</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> data-&gt;front<span style="color: #c678dd;">()</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">back</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">const</span>
<span style="color: #51afef;">{</span>
  check<span style="color: #c678dd;">(</span>0, <span style="color: #98be65;">"back on empty StrBlob."</span><span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> data-&gt;back<span style="color: #c678dd;">()</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">void</span> <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">pop_back</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  check<span style="color: #c678dd;">(</span>0, <span style="color: #98be65;">"pop_back on empty StrBlob."</span><span style="color: #c678dd;">)</span>;
  data-&gt;pop_back<span style="color: #c678dd;">()</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #ECBE7B;">iterator</span> <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">begin</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> StrBlobProxy<span style="color: #c678dd;">(</span>*<span style="color: #51afef;">this</span>, 0<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #ECBE7B;">iterator</span> <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">end</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> StrBlobProxy<span style="color: #c678dd;">(</span>*<span style="color: #51afef;">this</span>, data-&gt;size<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #ECBE7B;">const_iterator</span> <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">begin</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">const</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> ConstStrBlobProxy<span style="color: #c678dd;">(</span>*<span style="color: #51afef;">this</span>, 0<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #ECBE7B;">const_iterator</span> <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #c678dd;">end</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">const</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> ConstStrBlobProxy<span style="color: #c678dd;">(</span>*<span style="color: #51afef;">this</span>, data-&gt;size<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span> <span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">StrBlob</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>rhs.data-&gt;empty<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>
    <span style="color: #51afef;">return</span> os;

  <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #ECBE7B;">iterator</span> <span style="color: #dcaeea;">__pos</span> = rhs.begin<span style="color: #c678dd;">()</span>;
  <span style="color: #a9a1e1;">StrBlob</span>::<span style="color: #ECBE7B;">iterator</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__end</span> = rhs.end<span style="color: #c678dd;">()</span>;

  os &lt;&lt; <span style="color: #98be65;">"["</span>;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span>; __pos + 1 != __end; ++__pos<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    os &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"&#65292; "</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">return</span> os &lt;&lt; *__pos &lt;&lt; <span style="color: #98be65;">"]"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">b1 &#21644; b2 &#20849;&#20139;&#21516;&#26679;&#30340;&#24213;&#23618;&#25968;&#25454;</span>
  <span style="color: #ECBE7B;">StrBlob</span> <span style="color: #dcaeea;">b1</span> = <span style="color: #c678dd;">{</span><span style="color: #98be65;">"hello"</span>, <span style="color: #98be65;">"world"</span>, <span style="color: #98be65;">"evil"</span><span style="color: #c678dd;">}</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; b1;
  <span style="color: #ECBE7B;">StrBlob</span> <span style="color: #dcaeea;">b2</span> = b1;
  b2.push_back<span style="color: #c678dd;">(</span><span style="color: #98be65;">"C++"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; b1;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[hello，</td>
<td class="org-left">world，</td>
<td class="org-left">evil]</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">[hello，</td>
<td class="org-left">world，</td>
<td class="org-left">evil，</td>
<td class="org-left">C++]</td>
</tr>
</tbody>
</table>

<p>
在 <code>shared_ptr</code> 中使用自定义的 <code>delete</code> 操作
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">fmt/core.h</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">Connection</span> <span style="color: #51afef;">{</span>
  <span style="color: #c678dd;">Connection</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">int</span>* <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__descriptor</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #98be65;">(</span><span style="color: #98be65;">"Connected to descriptor {0}."</span>, *__descriptor<span style="color: #98be65;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
    descriptor = *__descriptor;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">descriptor</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #ECBE7B;">Connection</span> <span style="color: #c678dd;">connect</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">int</span>* <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">__descriptor</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> Connection<span style="color: #c678dd;">(</span>__descriptor<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">disconnect</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Connection</span>* <span style="color: #dcaeea;">con</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #c678dd;">(</span><span style="color: #98be65;">"Disconnected from descriptor {0}."</span>, con-&gt;descriptor<span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">descriptor</span> = 1;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#24314;&#31435;&#19968;&#20010;&#36830;&#25509;&#65292;con &#20998;&#37197;&#22312;&#26632;&#20869;&#23384;&#19978;</span>
  <span style="color: #ECBE7B;">Connection</span> <span style="color: #dcaeea;">con</span> = connect<span style="color: #c678dd;">(</span>&amp;descriptor<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558;&#36830;&#25509;&#32465;&#23450;&#21040;&#20849;&#20139;&#25351;&#38024;&#19978;&#65292;&#34429;&#28982;&#27492;&#22788; con &#19981;&#22312;&#20849;&#20139;&#20869;&#23384;&#19978;&#65292;&#25351;&#23450;&#20102;&#33258;&#23450;&#20041;&#30340;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">disconnect &#20989;&#25968;&#20445;&#35777;&#22312; p &#30340;&#29983;&#21629;&#21516;&#26399;&#32467;&#26463;&#26102;&#33021;&#22815;&#33258;&#21160; disconnect</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Connection</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">p</span><span style="color: #c678dd;">(</span>&amp;con, disconnect<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<p>
<code>shared_ptr</code> 和 <code>weak_ptr</code> 的常量性
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22768;&#26126;&#25351;&#38024;&#24120;&#37327;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">ip</span> = <span style="color: #a9a1e1;">std</span>::make_shared<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;(</span>1<span style="color: #c678dd;">)</span>;
  *ip = 2;                  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21487;&#20197;&#25913;&#21464;&#25351;&#38024;&#25351;&#21521;&#30340;&#20540;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">ip.reset(new int(3));  // &#26080;&#27861;&#25913;&#21464;&#25351;&#38024;&#26412;&#36523;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *ip &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22768;&#26126;&#25351;&#21521;&#24120;&#37327;&#30340;&#25351;&#38024;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">cip</span> = <span style="color: #a9a1e1;">std</span>::make_shared<span style="color: #c678dd;">&lt;</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;(</span>1<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">*cip = 2;             // &#26080;&#27861;&#25913;&#21464;&#25351;&#38024;&#25351;&#21521;&#30340;&#20540;</span>
  cip.reset<span style="color: #c678dd;">(</span><span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">int</span><span style="color: #98be65;">(</span>3<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;   <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21487;&#20197;&#23558;&#25351;&#38024;&#25351;&#21521;&#26032;&#20540;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; *cip &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">3</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc78d42f" class="outline-2">
<h2 id="orgc78d42f"><span class="section-number-2">15</span> <code>allocator</code></h2>
<div class="outline-text-2" id="text-15">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iterator</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">ivec</span><span style="color: #c678dd;">{</span>1, 2, 3, 4, 5<span style="color: #c678dd;">}</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">allocator</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">alloc</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20998;&#37197; 10 &#20010; int &#20803;&#32032;&#30340;&#20869;&#23384;</span>
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">p</span> = alloc.allocate<span style="color: #c678dd;">(</span>ivec.size<span style="color: #98be65;">()</span> * 2<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25335;&#36125; ivec &#20013;&#30340;&#20803;&#32032;&#26469;&#26500;&#36896;&#20174; p &#24320;&#22987;&#30340;&#20803;&#32032;</span>
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">q</span> = <span style="color: #a9a1e1;">std</span>::uninitialized_copy<span style="color: #c678dd;">(</span>ivec.begin<span style="color: #98be65;">()</span>, ivec.end<span style="color: #98be65;">()</span>, p<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558;&#21097;&#20313;&#30340;&#20803;&#32032;&#21021;&#22987;&#21270;&#20026; 24</span>
  <span style="color: #a9a1e1;">std</span>::uninitialized_fill_n<span style="color: #c678dd;">(</span>q, ivec.size<span style="color: #98be65;">()</span>, 24<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25171;&#21360;&#36755;&#20986;</span>
  <span style="color: #a9a1e1;">std</span>::copy<span style="color: #c678dd;">(</span>p, p + ivec.size<span style="color: #98be65;">()</span> * 2, <span style="color: #a9a1e1;">std</span>::ostream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #98be65;">&gt;(</span><span style="color: #a9a1e1;">std</span>::cout, <span style="color: #98be65;">", "</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">24</td>
<td class="org-right">24</td>
<td class="org-right">24</td>
<td class="org-right">24</td>
<td class="org-right">24</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc8bde69" class="outline-2">
<h2 id="orgc8bde69"><span class="section-number-2">16</span> 单例模式</h2>
<div class="outline-text-2" id="text-16">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">thread</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36890;&#36807;&#23616;&#37096;&#38745;&#24577;&#21464;&#37327;&#30340;&#29305;&#24615;&#20445;&#35777;&#20102;&#32447;&#31243;&#23433;&#20840;&#65307;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#19981;&#38656;&#35201;&#20351;&#29992;&#20849;&#20139;&#25351;&#38024;&#65292;&#20195;&#30721;&#31616;&#27905;&#65307;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#27880;&#24847;&#22312;&#20351;&#29992;&#30340;&#26102;&#20505;&#38656;&#35201;&#22768;&#26126;&#21333;&#20363;&#30340;&#24341;&#29992; Single&amp; &#25165;&#33021;&#33719;&#21462;&#23545;&#35937;&#12290;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">Singleton</span> <span style="color: #51afef;">{</span>
<span style="color: #51afef;">public</span>:
  ~<span style="color: #c678dd;">Singleton</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Destructor called!"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #c678dd;">}</span>
  <span style="color: #c678dd;">Singleton</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Singleton</span> <span style="color: #51afef;">const</span>&amp;<span style="color: #c678dd;">)</span> = <span style="color: #51afef;">delete</span>;
  <span style="color: #ECBE7B;">Singleton</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">=</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Singleton</span> <span style="color: #51afef;">const</span>&amp;<span style="color: #c678dd;">)</span> = <span style="color: #51afef;">delete</span>;
  <span style="color: #51afef;">static</span> <span style="color: #ECBE7B;">Singleton</span>&amp; <span style="color: #c678dd;">get_instance</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">If control enters the declaration concurrently while the variable is</span>
    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">being initialized, the concurrent execution shall wait for completion of</span>
    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">the initialization.</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Get instance.\n"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::flush;
    <span style="color: #51afef;">static</span> <span style="color: #ECBE7B;">Singleton</span> <span style="color: #dcaeea;">__instance</span>;
    <span style="color: #51afef;">return</span> __instance;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">private</span>:
  <span style="color: #c678dd;">Singleton</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Constructor called!"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">thread</span> <span style="color: #dcaeea;">t1</span><span style="color: #c678dd;">(</span>&amp;<span style="color: #a9a1e1;">Singleton</span>::get_instance<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">thread</span> <span style="color: #dcaeea;">t2</span><span style="color: #c678dd;">(</span>&amp;<span style="color: #a9a1e1;">Singleton</span>::get_instance<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">thread</span> <span style="color: #dcaeea;">t3</span><span style="color: #c678dd;">(</span>&amp;<span style="color: #a9a1e1;">Singleton</span>::get_instance<span style="color: #c678dd;">)</span>;
  t1.join<span style="color: #c678dd;">()</span>;
  t2.join<span style="color: #c678dd;">()</span>;
  t3.join<span style="color: #c678dd;">()</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Get</td>
<td class="org-left">instance.</td>
</tr>

<tr>
<td class="org-left">Get</td>
<td class="org-left">instance.</td>
</tr>

<tr>
<td class="org-left">Constructor</td>
<td class="org-left">called!</td>
</tr>

<tr>
<td class="org-left">Get</td>
<td class="org-left">instance.</td>
</tr>

<tr>
<td class="org-left">Destructor</td>
<td class="org-left">called!</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org527a59b" class="outline-2">
<h2 id="org527a59b"><span class="section-number-2">17</span> 容器的常量性</h2>
<div class="outline-text-2" id="text-17">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span> <span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::string<span style="color: #c678dd;">&gt;</span> <span style="color: #51afef;">const</span> <span style="color: #dcaeea;">svec</span><span style="color: #c678dd;">{</span><span style="color: #98be65;">"hello"</span><span style="color: #c678dd;">}</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">*svec.back() = std::string("world");</span>
<span style="color: #51afef;">}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd2d4f61" class="outline-2">
<h2 id="orgd2d4f61"><span class="section-number-2">18</span> 设计一个文本单词查询程序</h2>
<div class="outline-text-2" id="text-18">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iterator</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">fstream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">sstream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">map</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">set</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">fmt/core.h</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23450;&#20041;&#19968;&#20010;&#27010;&#24565;&#65292;&#31867;&#22411; T &#33021;&#22815;&#38544;&#24335;&#36716;&#25442;&#20026; std::size_t &#31867;&#22411;&#65288;C++20 required&#65289;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">concept</span> <span style="color: #dcaeea;">can_convert_to_size</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">is_convertible</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T</span>, <span style="color: #a9a1e1;">std</span>::size_t<span style="color: #51afef;">&gt;</span>::value;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26681;&#25454; size &#30340;&#20540;&#36820;&#22238;&#21333;&#25968;&#25110;&#22797;&#25968;&#24418;&#24335;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">can_convert_to_size</span> <span style="color: #dcaeea;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #c678dd;">make_plural</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #dcaeea;">size</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">__one</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">__more</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> <span style="color: #c678dd;">(</span>size &gt; 1? __more : __one<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26597;&#35810;&#32467;&#26524;&#31867;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">QueryResult</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26597;&#35810;&#22120;&#31867;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">TextQuery</span> <span style="color: #51afef;">{</span>
<span style="color: #51afef;">public</span>:
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">line_no</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span>::size_type;  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#34892;&#21495;&#25968;&#25454;&#31867;&#22411;</span>
  <span style="color: #c678dd;">TextQuery</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ifstream</span>&amp;<span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">QueryResult</span> <span style="color: #c678dd;">query</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp;<span style="color: #c678dd;">)</span> <span style="color: #51afef;">const</span>;
<span style="color: #51afef;">private</span>:
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">text</span>;      <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20445;&#23384;&#35835;&#21462;&#30340;&#25991;&#26412;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20445;&#23384;&#21333;&#35789;&#34892;&#21495;&#30340;&#38598;&#21512;&#30340;&#21704;&#24076;&#34920;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">map</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">set</span><span style="color: #a9a1e1;">&lt;</span>line_no<span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">word_map</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26597;&#35810;&#32467;&#26524;&#31867;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">QueryResult</span> <span style="color: #51afef;">{</span>
  <span style="color: #51afef;">friend</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">QueryResult</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">public</span>:
  <span style="color: #c678dd;">QueryResult</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">__sought</span>,
              <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">set</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #a9a1e1;">TextQuery</span>::line_no<span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;</span> <span style="color: #dcaeea;">__lines</span>,
              <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #a9a1e1;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #a9a1e1;">&gt;</span><span style="color: #98be65;">&gt;</span> <span style="color: #dcaeea;">__text</span><span style="color: #c678dd;">)</span> :
    sought<span style="color: #c678dd;">(</span>__sought<span style="color: #c678dd;">)</span>, lines<span style="color: #c678dd;">(</span>__lines<span style="color: #c678dd;">)</span>, text<span style="color: #c678dd;">(</span>__text<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">private</span>:
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">sought</span>;                                  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26597;&#35810;&#30340;&#21333;&#35789;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">set</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">TextQuery</span>::line_no<span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">lines</span>; <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20986;&#29616;&#30340;&#34892;&#21495;&#38598;&#21512;&#30340;&#25351;&#38024;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">text</span>;      <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36755;&#20837;&#25991;&#26412;&#30340;&#25351;&#38024;</span>
<span style="color: #51afef;">}</span>;

<span style="color: #a9a1e1;">TextQuery</span>::<span style="color: #c678dd;">TextQuery</span><span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ifstream</span>&amp; <span style="color: #dcaeea;">ifs</span><span style="color: #51afef;">)</span> : text<span style="color: #51afef;">(</span><span style="color: #51afef;">new</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">buf</span>, <span style="color: #dcaeea;">word</span>;             <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#34892;&#32531;&#20914;&#65292;&#21333;&#35789;&#32531;&#20914;</span>
  <span style="color: #ECBE7B;">line_no</span> <span style="color: #dcaeea;">number</span>;                    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#34892;&#21495;</span>

  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::getline<span style="color: #98be65;">(</span>ifs, buf<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    text-&gt;push_back<span style="color: #98be65;">(</span>buf<span style="color: #98be65;">)</span>;            <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20445;&#23384;&#24403;&#21069;&#34892;&#21040; text</span>
    number = text-&gt;size<span style="color: #98be65;">()</span> - 1;       <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#24403;&#21069;&#34892;&#21495;</span>

    <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">istringstream</span> <span style="color: #dcaeea;">line</span><span style="color: #98be65;">(</span>buf<span style="color: #98be65;">)</span>;    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20174;&#24403;&#21069;&#34892;&#29983;&#25104;&#23383;&#31526;&#20018;&#27969;</span>
    <span style="color: #51afef;">while</span> <span style="color: #98be65;">(</span>line &gt;&gt; word<span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #51afef;">auto</span>&amp; <span style="color: #dcaeea;">lines</span> = word_map<span style="color: #a9a1e1;">[</span>word<span style="color: #a9a1e1;">]</span>;  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25351;&#21521; word &#23545;&#24212; set &#30340;&#20849;&#20139;&#25351;&#38024;</span>
      <span style="color: #51afef;">if</span> <span style="color: #a9a1e1;">(</span><span style="color: #51afef; font-weight: bold;">!</span>lines<span style="color: #a9a1e1;">)</span> <span style="color: #a9a1e1;">{</span>                  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25351;&#38024;&#20026;&#31354;&#21017;&#20998;&#37197;&#19968;&#20010;&#26032;&#30340; set</span>
        lines.reset<span style="color: #4db5bd;">(</span><span style="color: #51afef;">new</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">set</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">line_no</span><span style="color: #51afef;">&gt;</span><span style="color: #4db5bd;">)</span>;
      <span style="color: #a9a1e1;">}</span>
      lines-&gt;insert<span style="color: #a9a1e1;">(</span>number<span style="color: #a9a1e1;">)</span>;
    <span style="color: #98be65;">}</span>
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">QueryResult</span> <span style="color: #a9a1e1;">TextQuery</span>::<span style="color: #c678dd;">query</span><span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">sought</span><span style="color: #51afef;">)</span> <span style="color: #51afef;">const</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22914;&#26524;&#27809;&#26377;&#25214;&#21040; sought, &#36820;&#22238;&#19968;&#20010;&#31354; set &#30340;&#25351;&#38024;</span>
  <span style="color: #51afef;">static</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">set</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">TextQuery</span>::<span style="color: #ECBE7B;">line_no</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span>
    <span style="color: #dcaeea;">null</span><span style="color: #c678dd;">(</span><span style="color: #51afef;">new</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">set</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">TextQuery</span>::<span style="color: #ECBE7B;">line_no</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20351;&#29992; find &#26597;&#25214;&#21333;&#35789;&#65292;&#38450;&#27490;&#23558;&#21333;&#35789;&#21152;&#20837;&#21040; map &#20013;</span>
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">locate</span> = word_map.find<span style="color: #c678dd;">(</span>sought<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>locate == word_map.end<span style="color: #98be65;">()</span><span style="color: #c678dd;">)</span>
    <span style="color: #51afef;">return</span> QueryResult<span style="color: #c678dd;">(</span>sought, null, text<span style="color: #c678dd;">)</span>;  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22914;&#26524;&#27809;&#25214;&#21040; sought &#36820;&#22238;&#31354; set &#25351;&#38024;</span>
  <span style="color: #51afef;">else</span>
    <span style="color: #51afef;">return</span> QueryResult<span style="color: #c678dd;">(</span>sought, locate-&gt;second, text<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span><span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">QueryResult</span> <span style="color: #51afef;">const</span>&amp; <span style="color: #dcaeea;">rhs</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  os &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #c678dd;">(</span><span style="color: #98be65;">"[{0}] occurs in {1} {2}."</span>, rhs.sought, rhs.lines-&gt;size<span style="color: #98be65;">()</span>,
                    make_plural<span style="color: #98be65;">(</span>rhs.lines-&gt;size<span style="color: #a9a1e1;">()</span>, <span style="color: #98be65;">"line"</span>, <span style="color: #98be65;">"lines"</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">for</span> <span style="color: #c678dd;">(</span><span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">num</span> : *rhs.lines<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    os &lt;&lt; <span style="color: #a9a1e1;">fmt</span>::format<span style="color: #98be65;">(</span><span style="color: #98be65;">"\t(line {0}) {1}"</span>, num + 1, *<span style="color: #a9a1e1;">(</span>rhs.text-&gt;begin<span style="color: #4db5bd;">()</span> + num<span style="color: #a9a1e1;">)</span><span style="color: #98be65;">)</span>
       &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #c678dd;">}</span>
  <span style="color: #51afef;">return</span> os;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36816;&#34892;&#26597;&#35810;&#25805;&#20316;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">TextQuery&amp;: &#20256;&#20837;&#19968;&#20010;&#26597;&#35810;&#22120;&#30340;&#24341;&#29992;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">std::istream_iterator&lt;std::string&gt;: &#20256;&#20837;&#19968;&#20010;&#36755;&#20837;&#27969;&#36845;&#20195;&#22120;&#65292;&#22909;&#22788;&#26159;&#21487;&#20197;&#20860;&#23481;&#20174;&#26631;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20934;&#36755;&#20837;&#25110;&#20174;&#25991;&#20214;&#27969;&#25110;&#23383;&#31526;&#20018;&#27969;&#36755;&#20837;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">runQueries</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">TextQuery</span>&amp; <span style="color: #dcaeea;">__text_query</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">istream_iterator</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">__is_iter</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">word</span>;
  <span style="color: #51afef;">while</span> <span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">true</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Please input the word you want to query: "</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::flush;
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
    word = *__is_iter++;

    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#35835;&#21040; q &#30340;&#26102;&#20505;&#36864;&#20986;</span>
    <span style="color: #51afef;">if</span> <span style="color: #98be65;">(</span>word == <span style="color: #98be65;">"q"</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
      <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Quit!"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
      <span style="color: #51afef;">break</span>;
    <span style="color: #98be65;">}</span>

    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; __text_query.query<span style="color: #98be65;">(</span>word<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ifstream</span> <span style="color: #dcaeea;">ifs</span>;
  ifs.open<span style="color: #c678dd;">(</span><span style="color: #98be65;">"/home/cycoe/input.txt"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">TextQuery</span> <span style="color: #dcaeea;">tq</span><span style="color: #c678dd;">(</span>ifs<span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#29992;&#23383;&#31526;&#20018;&#27969;&#27169;&#25311;&#26631;&#20934;&#36755;&#20837;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">command</span><span style="color: #c678dd;">(</span><span style="color: #98be65;">"it a q"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">istringstream</span> <span style="color: #dcaeea;">iss</span><span style="color: #c678dd;">(</span>command<span style="color: #c678dd;">)</span>;
  runQueries<span style="color: #c678dd;">(</span>tq, <span style="color: #a9a1e1;">std</span>::istream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;(</span>iss<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaeebbce" class="outline-2">
<h2 id="orgaeebbce"><span class="section-number-2">19</span> 树的遍历</h2>
<div class="outline-text-2" id="text-19">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iterator</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20108;&#21449;&#26641;&#33410;&#28857;&#31867;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">Node</span> <span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21494;&#23376;&#33410;&#28857;&#30340;&#26500;&#36896;&#26041;&#27861;</span>
  <span style="color: #c678dd;">Node</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #dcaeea;">__value</span>, <span style="color: #ECBE7B;">Node</span>* <span style="color: #dcaeea;">__left</span> = <span style="color: #a9a1e1;">nullptr</span>, <span style="color: #ECBE7B;">Node</span>* <span style="color: #dcaeea;">__right</span> = <span style="color: #a9a1e1;">nullptr</span><span style="color: #c678dd;">)</span> :
    value<span style="color: #c678dd;">(</span>__value<span style="color: #c678dd;">)</span>, left<span style="color: #c678dd;">(</span>__left<span style="color: #c678dd;">)</span>, right<span style="color: #c678dd;">(</span>__right<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25335;&#36125;&#33410;&#28857;&#65288;&#27973;&#25335;&#36125;&#65289;</span>
  <span style="color: #c678dd;">Node</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">Node</span>* <span style="color: #dcaeea;">rhs</span><span style="color: #c678dd;">)</span> :
    value<span style="color: #c678dd;">(</span>rhs-&gt;value<span style="color: #c678dd;">)</span>, left<span style="color: #c678dd;">(</span>rhs-&gt;left<span style="color: #c678dd;">)</span>, right<span style="color: #c678dd;">(</span>rhs-&gt;right<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558; rhs &#30340;&#24038;&#21491;&#23376;&#26641;&#32622;&#20026; nullptr&#65292;&#38450;&#27490; rhs &#26512;&#26500;&#26102;&#23558;&#23376;&#26641;&#26512;&#26500;</span>
    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#31070;&#22855;&#30340;&#26159;&#20351;&#29992;&#24341;&#29992;&#30340;&#35805;&#20250;&#25552;&#31034;&#24341;&#29992;&#30340;&#23545;&#35937;&#26159;&#19968;&#20010;&#21491;&#20540;</span>
    rhs-&gt;left = <span style="color: #a9a1e1;">nullptr</span>;
    rhs-&gt;right = <span style="color: #a9a1e1;">nullptr</span>;
  <span style="color: #c678dd;">}</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36882;&#24402;&#26500;&#36896;</span>
  <span style="color: #c678dd;">Node</span><span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #dcaeea;">__value</span>, <span style="color: #ECBE7B;">Node</span> <span style="color: #dcaeea;">__left</span>, <span style="color: #ECBE7B;">Node</span> <span style="color: #dcaeea;">__right</span><span style="color: #c678dd;">)</span> : value<span style="color: #c678dd;">(</span>__value<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span>
    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20351;&#29992;&#21160;&#24577;&#20869;&#23384;&#26367;&#25442;&#26632;&#20869;&#23384;</span>
    left = <span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">Node</span><span style="color: #98be65;">(</span>&amp;__left<span style="color: #98be65;">)</span>;
    right = <span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">Node</span><span style="color: #98be65;">(</span>&amp;__right<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
  ~<span style="color: #c678dd;">Node</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Delete Node("</span> &lt;&lt; value &lt;&lt; <span style="color: #98be65;">")."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
    <span style="color: #51afef;">delete</span> left;
    <span style="color: #51afef;">delete</span> right;
  <span style="color: #c678dd;">}</span>
  <span style="color: #ECBE7B;">T</span> <span style="color: #dcaeea;">value</span>;
  <span style="color: #ECBE7B;">Node</span>* <span style="color: #dcaeea;">left</span> = <span style="color: #a9a1e1;">nullptr</span>;
  <span style="color: #ECBE7B;">Node</span>* <span style="color: #dcaeea;">right</span> = <span style="color: #a9a1e1;">nullptr</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">preorder_traverse</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Node</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span>* <span style="color: #dcaeea;">tree</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">iter</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span><span style="color: #51afef; font-weight: bold;">!</span>tree<span style="color: #c678dd;">)</span>
    <span style="color: #51afef;">return</span>;
  *iter++ = tree-&gt;value;
  preorder_traverse<span style="color: #c678dd;">(</span>tree-&gt;left, iter<span style="color: #c678dd;">)</span>;
  preorder_traverse<span style="color: #c678dd;">(</span>tree-&gt;right, iter<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">midorder_traverse</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Node</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span>* <span style="color: #dcaeea;">tree</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">iter</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span><span style="color: #51afef; font-weight: bold;">!</span>tree<span style="color: #c678dd;">)</span>
    <span style="color: #51afef;">return</span>;
  midorder_traverse<span style="color: #c678dd;">(</span>tree-&gt;left, iter<span style="color: #c678dd;">)</span>;
  *iter++ = tree-&gt;value;
  midorder_traverse<span style="color: #c678dd;">(</span>tree-&gt;right, iter<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Iter</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">postorder_traverse</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Node</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span>* <span style="color: #dcaeea;">tree</span>, <span style="color: #ECBE7B;">Iter</span> <span style="color: #dcaeea;">iter</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span><span style="color: #51afef; font-weight: bold;">!</span>tree<span style="color: #c678dd;">)</span>
    <span style="color: #51afef;">return</span>;
  postorder_traverse<span style="color: #c678dd;">(</span>tree-&gt;left, iter<span style="color: #c678dd;">)</span>;
  *iter++ = tree-&gt;value;
  postorder_traverse<span style="color: #c678dd;">(</span>tree-&gt;right, iter<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">argc</span>, <span style="color: #ECBE7B;">char</span>* <span style="color: #dcaeea;">argv</span><span style="color: #c678dd;">[]</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">Node</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span>* <span style="color: #dcaeea;">itree</span> = <span style="color: #51afef;">new</span> Node<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;(</span><span style="color: #98be65;">{</span>0, <span style="color: #a9a1e1;">{</span>1, <span style="color: #4db5bd;">{</span>2<span style="color: #4db5bd;">}</span>, <span style="color: #4db5bd;">{</span>3<span style="color: #4db5bd;">}</span><span style="color: #a9a1e1;">}</span>, <span style="color: #a9a1e1;">{</span>4, <span style="color: #4db5bd;">{</span>5<span style="color: #4db5bd;">}</span>, <span style="color: #4db5bd;">{</span>6<span style="color: #4db5bd;">}</span><span style="color: #a9a1e1;">}</span><span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Preorder traverse: "</span>;
  preorder_traverse<span style="color: #c678dd;">(</span>itree, <span style="color: #a9a1e1;">std</span>::ostream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #98be65;">&gt;(</span><span style="color: #a9a1e1;">std</span>::cout, <span style="color: #98be65;">", "</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Midorder traverse: "</span>;
  midorder_traverse<span style="color: #c678dd;">(</span>itree, <span style="color: #a9a1e1;">std</span>::ostream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #98be65;">&gt;(</span><span style="color: #a9a1e1;">std</span>::cout, <span style="color: #98be65;">", "</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Postorder traverse: "</span>;
  postorder_traverse<span style="color: #c678dd;">(</span>itree, <span style="color: #a9a1e1;">std</span>::ostream_iterator<span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #98be65;">&gt;(</span><span style="color: #a9a1e1;">std</span>::cout, <span style="color: #98be65;">", "</span><span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #51afef;">delete</span> itree;

  <span style="color: #51afef;">return</span> 0;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(4).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(6).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(5).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(1).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(3).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(2).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Preorder</td>
<td class="org-left">traverse:</td>
<td class="org-left">0,</td>
<td class="org-left">1,</td>
<td class="org-left">2,</td>
<td class="org-left">3,</td>
<td class="org-left">4,</td>
<td class="org-left">5,</td>
<td class="org-left">6,</td>
</tr>

<tr>
<td class="org-left">Midorder</td>
<td class="org-left">traverse:</td>
<td class="org-left">2,</td>
<td class="org-left">1,</td>
<td class="org-left">3,</td>
<td class="org-left">0,</td>
<td class="org-left">5,</td>
<td class="org-left">4,</td>
<td class="org-left">6,</td>
</tr>

<tr>
<td class="org-left">Postorder</td>
<td class="org-left">traverse:</td>
<td class="org-left">2,</td>
<td class="org-left">1,</td>
<td class="org-left">3,</td>
<td class="org-left">0,</td>
<td class="org-left">5,</td>
<td class="org-left">4,</td>
<td class="org-left">6,</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(0).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(1).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(2).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(3).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(4).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(5).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Delete</td>
<td class="org-left">Node(6).</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org71976a6" class="outline-2">
<h2 id="org71976a6"><span class="section-number-2">20</span> <code>std::pair</code> 与 <code>std::tuple</code></h2>
<div class="outline-text-2" id="text-20">
<p>
<code>std::pair</code> 与 <code>std::tuple</code> 是 <code>C++</code> 中的通用工具类型， <code>std::pair</code> 表示会同时出现的变量
对，常用在 <code>map</code> 中。 <code>std::tuple</code> 表示异质元素列，可视为 <code>std::pair</code> 的扩展长度类型，
在 <code>C++98</code> 中通过对不同元素长度的 tuple 进行逐个定义实现， <code>C++11</code> 引入变长参数模板
后就可通过更加简单的方式定义。
</p>
</div>

<div id="outline-container-orgc8fbd71" class="outline-3">
<h3 id="orgc8fbd71"><span class="section-number-3">20.1</span> <code>std::pair</code></h3>
<div class="outline-text-3" id="text-20-1">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">utility</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">tuple</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26377;&#20004;&#31181;&#26041;&#24335;&#26500;&#36896;&#19968;&#20010; pair</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">1. &#20351;&#29992; make_pair &#26041;&#24335;&#36827;&#34892;&#26500;&#36896;</span>
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">p1</span> = <span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #c678dd;">(</span>24, <span style="color: #98be65;">"Hello, world!"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">2. &#20351;&#29992; pair &#30340;&#26500;&#36896;&#20989;&#25968;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">pair</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span>, <span style="color: #a9a1e1;">std</span>::string<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">p2</span><span style="color: #c678dd;">(</span>24, <span style="color: #98be65;">"Hello, C++!"</span><span style="color: #c678dd;">)</span>;

  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">s1</span>, <span style="color: #dcaeea;">s2</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26377;&#19977;&#31181;&#26041;&#24335;&#33719;&#21462; pair &#20013;&#30340;&#20803;&#32032;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">1. &#20351;&#29992; first &#25110; second</span>
  s1 = p1.second;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">2. &#20351;&#29992; tuple &#30340; get &#20803;&#32032;&#26041;&#27861;&#65292;&#20174; p1 &#20013;&#21462; 1 &#21495;&#20803;&#32032;&#65292;&#27880;&#24847; tuple &#19981;&#26159;&#23547;&#24120;&#30340;&#23481;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22120;&#22240;&#27492;&#19981;&#20801;&#35768;&#36845;&#20195;&#65292;&#20063;&#22240;&#27492; get &#26159;&#20010;&#32534;&#35793;&#26399;&#25805;&#20316;&#12290;</span>
  s1 = <span style="color: #a9a1e1;">std</span>::get<span style="color: #c678dd;">&lt;</span>1<span style="color: #c678dd;">&gt;(</span>p1<span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">3. &#20351;&#29992; tie &#26041;&#27861;&#26500;&#36896;&#19968;&#20010;&#25509;&#25910;&#22120;&#65292;&#24182;&#29992; p2 &#32473;&#20854;&#36171;&#20540;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#31561;&#20215;&#20110; std::make_pair&lt;std::ref(i2), std::ref(s2)&gt; = p2;</span>
  <span style="color: #a9a1e1;">std</span>::tie<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::ignore, s2<span style="color: #c678dd;">)</span> = p2;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"s1 is "</span> &lt;&lt; s1 &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"s2 is "</span> &lt;&lt; s2 &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">s1 is Hello</td>
<td class="org-left">world!</td>
</tr>

<tr>
<td class="org-left">s2 is Hello</td>
<td class="org-left">C++!</td>
</tr>
</tbody>
</table>

<p>
<code>std::get</code> 是 <code>&lt;tuple&gt;</code> 头文件定义的一个方法，用于从 tuple 中获取元素。 <code>get</code> 方法是一
个编译期的方法，tuple 也无法像普通容器一样进行迭代，因为 <code>C++</code> 是强类型静态语言，
而 tuple 又是一个异质列表，编译期必须在编译期确定要取出的元素类型
</p>
</div>
</div>

<div id="outline-container-orge713317" class="outline-3">
<h3 id="orge713317"><span class="section-number-3">20.2</span> <code>std::tuple</code></h3>
<div class="outline-text-3" id="text-20-2">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">utility</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">tuple</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">tuple &#30340;&#26500;&#36896;&#19982; pair &#31867;&#20284;</span>
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">t1</span> = <span style="color: #a9a1e1;">std</span>::make_tuple<span style="color: #c678dd;">(</span>24, <span style="color: #98be65;">"Hello, world!"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">tuple</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span>, <span style="color: #a9a1e1;">std</span>::string<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">t2</span><span style="color: #c678dd;">(</span>24, <span style="color: #98be65;">"Hello, C++!"</span><span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">tuple &#22312;&#27604;&#36739;&#26102;&#20351;&#29992;&#23383;&#20856;&#24207;&#20381;&#27425;&#23545;&#20803;&#32032;&#36827;&#34892;&#27604;&#36739;&#65292;&#20294;&#27880;&#24847;&#19982; pair &#19981;&#21516;&#30340;&#26159; tuple &#20250;</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#36827;&#34892;&#31867;&#22411;&#36716;&#25442;&#65292;p1 &#20250;&#30001;std::tuple&lt;int, char const*&gt; &#31867;&#22411;&#36716;&#25442;&#20026; std::tuple&lt;int,</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">std::string&gt;</span>
  <span style="color: #51afef;">if</span> <span style="color: #c678dd;">(</span>t1 &lt; t2<span style="color: #c678dd;">)</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"t1 is smaller than t2."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">else</span>
    <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"t2 is smaller than t1."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<pre class="example">
t2 is smaller than t1.
</pre>


<p>
<code>tuple</code> 包含一些辅助函数
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">tuple</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">utility</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">typeinfo</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">n</span><span style="color: #c678dd;">{}</span>;

  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">tt</span> = <span style="color: #a9a1e1;">std</span>::tuple_cat<span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::make_tuple<span style="color: #98be65;">(</span>42, 3,14, <span style="color: #98be65;">"Hello"</span><span style="color: #98be65;">)</span>,
                           <span style="color: #a9a1e1;">std</span>::make_pair<span style="color: #98be65;">(</span>24, <span style="color: #98be65;">"world"</span><span style="color: #98be65;">)</span>,
                           <span style="color: #a9a1e1;">std</span>::tie<span style="color: #98be65;">(</span>n<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"tt has "</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">tuple_size</span><span style="color: #c678dd;">&lt;</span><span style="color: #51afef;">decltype</span><span style="color: #98be65;">(</span>tt<span style="color: #98be65;">)</span><span style="color: #c678dd;">&gt;</span>::value &lt;&lt; <span style="color: #98be65;">" elements."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Type of n is "</span> &lt;&lt; <span style="color: #51afef;">typeid</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">tuple_element</span><span style="color: #98be65;">&lt;</span>5, <span style="color: #51afef;">decltype</span><span style="color: #a9a1e1;">(</span>tt<span style="color: #a9a1e1;">)</span><span style="color: #98be65;">&gt;</span>::type<span style="color: #c678dd;">)</span>.name<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-right">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">tt</td>
<td class="org-left">has</td>
<td class="org-right">7</td>
<td class="org-left">elements.</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Type</td>
<td class="org-left">of</td>
<td class="org-right">n</td>
<td class="org-left">is</td>
<td class="org-left">PKc</td>
</tr>
</tbody>
</table>

<p>
利用模板元编程实现打印任意长度元组
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">tuple</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25171;&#21360; tuple &#20013; IDX &#21495;&#20803;&#32032;&#30340;&#21161;&#25163;&#31867;&#27169;&#26495;&#65288;&#36882;&#24402;&#26041;&#27861;&#65289;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">IDX</span>, <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">MAX</span>, <span style="color: #51afef;">typename</span><span style="color: #c678dd;">...</span> <span style="color: #ECBE7B;">Args</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">PRINT_TUPLE</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">static</span> <span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">print</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #51afef;">const</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">tuple</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">Args</span><span style="color: #c678dd;">...</span><span style="color: #98be65;">&gt;</span>&amp; <span style="color: #dcaeea;">t</span><span style="color: #c678dd;">)</span>
  <span style="color: #c678dd;">{</span>
    os &lt;&lt; <span style="color: #a9a1e1;">std</span>::get<span style="color: #98be65;">&lt;</span>IDX<span style="color: #98be65;">&gt;(</span>t<span style="color: #98be65;">)</span> &lt;&lt; <span style="color: #98be65;">(</span>IDX + 1 == MAX ? <span style="color: #98be65;">""</span> : <span style="color: #98be65;">", "</span><span style="color: #98be65;">)</span>;
    <span style="color: #a9a1e1;">PRINT_TUPLE</span><span style="color: #98be65;">&lt;</span>IDX + 1, MAX, <span style="color: #ECBE7B;">Args</span><span style="color: #c678dd;">...</span><span style="color: #98be65;">&gt;</span>::print<span style="color: #98be65;">(</span>os, t<span style="color: #98be65;">)</span>;
  <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">PRINT_TUPLE &#30340;&#20559;&#29305;&#21270;&#27169;&#26495;&#65288;&#36882;&#24402;&#20986;&#21475;&#65289;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">MAX</span>, <span style="color: #51afef;">typename</span><span style="color: #c678dd;">...</span> <span style="color: #ECBE7B;">Args</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">PRINT_TUPLE</span><span style="color: #51afef;">&lt;</span>MAX, MAX, <span style="color: #ECBE7B;">Args</span><span style="color: #c678dd;">...</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">static</span> <span style="color: #ECBE7B;">void</span> <span style="color: #dcaeea;">print</span><span style="color: #c678dd;">(</span><span style="color: #a9a1e1;">std</span>::ostream&amp; os, <span style="color: #51afef;">const</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">tuple</span><span style="color: #98be65;">&lt;</span><span style="color: #ECBE7B;">Args</span><span style="color: #c678dd;">...</span><span style="color: #98be65;">&gt;</span>&amp; t<span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#37325;&#36733; &lt;&lt; &#36816;&#31639;&#31526;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span><span style="color: #c678dd;">...</span> <span style="color: #ECBE7B;">Args</span><span style="color: #51afef;">&gt;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span><span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #51afef;">const</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">tuple</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Args</span><span style="color: #c678dd;">...</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">t</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  os &lt;&lt; <span style="color: #98be65;">"["</span>;
  <span style="color: #a9a1e1;">PRINT_TUPLE</span><span style="color: #c678dd;">&lt;</span>0, <span style="color: #51afef;">sizeof</span><span style="color: #c678dd;">...</span><span style="color: #98be65;">(</span>Args<span style="color: #98be65;">)</span>, <span style="color: #ECBE7B;">Args</span><span style="color: #c678dd;">...</span><span style="color: #c678dd;">&gt;</span>::print<span style="color: #c678dd;">(</span>os, t<span style="color: #c678dd;">)</span>;
  <span style="color: #51afef;">return</span> os &lt;&lt; <span style="color: #98be65;">"]"</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">auto</span> <span style="color: #dcaeea;">t</span> = <span style="color: #a9a1e1;">std</span>::make_tuple<span style="color: #c678dd;">(</span>77, 3.14, <span style="color: #98be65;">"Hello, world!"</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; t &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[77</td>
<td class="org-right">3.14</td>
<td class="org-left">Hello</td>
<td class="org-left">world!]</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-org1a7c9bc" class="outline-2">
<h2 id="org1a7c9bc"><span class="section-number-2">21</span> 智能指针与自定义 <code>deleter</code></h2>
<div class="outline-text-2" id="text-21">
<p>
在使用智能指针时，我们可以自己指定使用的 <code>deleter</code> 删除器来指定删除行为
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">vector</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">string</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">memory</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21019;&#24314;&#19968;&#20010;&#25351;&#21521; string &#30340;&#26234;&#33021;&#25351;&#38024;&#65292;&#21516;&#26102;&#25351;&#23450; deleter</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::string<span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">nico</span><span style="color: #c678dd;">(</span><span style="color: #51afef;">new</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">(</span><span style="color: #98be65;">"Nico"</span><span style="color: #98be65;">)</span>,
                                    <span style="color: #98be65;">[]</span> <span style="color: #98be65;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span>* <span style="color: #dcaeea;">p</span><span style="color: #98be65;">)</span> <span style="color: #98be65;">{</span>
                                      <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"delete "</span> &lt;&lt; *p &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
                                    <span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21019;&#24314;&#19968;&#20010;&#21517;&#23383;&#39034;&#24207;&#21015;&#34920;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">vector</span><span style="color: #c678dd;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #98be65;">&lt;</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span><span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">names</span>;
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23558;&#21517;&#23383;&#25351;&#38024;&#21152;&#20837;&#21015;&#34920;</span>
  names.push_back<span style="color: #c678dd;">(</span>nico<span style="color: #c678dd;">)</span>;
  names.push_back<span style="color: #c678dd;">(</span>nico<span style="color: #c678dd;">)</span>;

  nico = <span style="color: #a9a1e1;">nullptr</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<pre class="example">
delete Nico
</pre>


<p>
另一种情况是在处理 <code>Array</code> 时， <code>shared_ptr</code> 默认的删除器是 <code>delete</code> 而不是 <code>delete[]</code>
，当处理 <code>Array</code> 需要传入自定义的删除器
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#33021;&#36890;&#36807;&#32534;&#35793;&#20294;&#23454;&#38469;&#20250;&#23548;&#33268;&#19981;&#23436;&#20840;&#37322;&#25918;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">std::shared_ptr&lt;int&gt; p(new int[10]);</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26500;&#36896; shared_ptr &#30340;&#21516;&#26102;&#25351;&#23450;&#21024;&#38500;&#22120;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #51afef;">&gt;</span> <span style="color: #dcaeea;">p</span><span style="color: #51afef;">(</span><span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">[</span>10<span style="color: #c678dd;">]</span>, <span style="color: #c678dd;">[]</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">int</span>* <span style="color: #dcaeea;">p</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #51afef;">delete</span><span style="color: #98be65;">[]</span> p; <span style="color: #c678dd;">}</span><span style="color: #51afef;">)</span>;
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25110;&#32773;&#20351;&#29992;&#20026; =unique_ptr= &#32780;&#25552;&#20379;&#30340;&#36741;&#21161;&#20989;&#25968;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">shared_ptr</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #51afef;">&gt;</span> <span style="color: #dcaeea;">q</span><span style="color: #51afef;">(</span><span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">[</span>10<span style="color: #c678dd;">]</span>, <span style="color: #a9a1e1;">std</span>::default_delete<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #98be65;">[]</span><span style="color: #c678dd;">&gt;()</span><span style="color: #51afef;">)</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23545;&#20110; unique_ptr &#25105;&#20204;&#21487;&#20197;&#21482;&#25552;&#20379;&#23545;&#24212;&#20803;&#32032;&#30340;&#31867;&#22411;&#29978;&#33267;&#19981;&#29992;&#25351;&#26126;&#38271;&#24230;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">unique_ptr</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">[]</span><span style="color: #51afef;">&gt;</span> <span style="color: #dcaeea;">p</span><span style="color: #51afef;">(</span><span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">[</span>10<span style="color: #c678dd;">]</span><span style="color: #51afef;">)</span>;
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20294;&#26159;&#23545;&#20110; shared_ptr &#23601;&#26080;&#27861;&#36890;&#36807;&#32534;&#35793;</span>
<span style="color: #5B6268;">// </span><span style="color: #5B6268;">std::shared_ptr&lt;int[]&gt; p(new int[10]);</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#21478;&#22806;&#65292;&#23545;&#20110; unique_ptr &#22312;&#25351;&#26126;&#21024;&#38500;&#22120;&#26102;&#38656;&#35201;&#25351;&#26126;&#31532;&#19968;&#20010;&#27169;&#26495;&#21442;&#25968;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">unique_ptr</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">int</span>, <span style="color: #ECBE7B;">void</span><span style="color: #c678dd;">(</span>*<span style="color: #c678dd;">)(</span><span style="color: #ECBE7B;">int</span>*<span style="color: #c678dd;">)</span><span style="color: #51afef;">&gt;</span> <span style="color: #dcaeea;">p</span><span style="color: #51afef;">(</span><span style="color: #51afef;">new</span> <span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">[</span>10<span style="color: #c678dd;">]</span>, <span style="color: #c678dd;">[]</span> <span style="color: #c678dd;">(</span><span style="color: #ECBE7B;">int</span>* <span style="color: #dcaeea;">p</span><span style="color: #c678dd;">)</span> <span style="color: #c678dd;">{</span> <span style="color: #51afef;">delete</span><span style="color: #98be65;">[]</span> p; <span style="color: #c678dd;">}</span><span style="color: #51afef;">)</span>;
</pre>
</div>
</div>
</div>
<div id="outline-container-org78aa69a" class="outline-2">
<h2 id="org78aa69a"><span class="section-number-2">22</span> Type Trait</h2>
<div class="outline-text-2" id="text-22">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">type_traits</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#26631;&#20934;&#24211;&#20013;&#25152;&#26377;&#30340;&#31867;&#22411;&#21028;&#21035;&#24335;&#30340;&#20135;&#20986;&#31867;&#22411;&#37117;&#29305;&#21270;&#33258;&#19968;&#20010;&#21483; =std::integral_constant= &#30340;&#27169;&#26495;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span>, <span style="color: #ECBE7B;">T</span> <span style="color: #dcaeea;">val</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">integral_constant</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">static</span> <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">T</span> <span style="color: #dcaeea;">value</span> = val;
  <span style="color: #51afef;">typedef</span> <span style="color: #ECBE7B;">T</span> <span style="color: #ECBE7B;">value_type</span>;
  <span style="color: #51afef;">typedef</span> <span style="color: #ECBE7B;">integral_constant</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span>, value<span style="color: #c678dd;">&gt;</span> <span style="color: #ECBE7B;">type</span>;
  <span style="color: #51afef;">constexpr</span> <span style="color: #51afef;">operator</span> <span style="color: #ECBE7B;">value_type</span><span style="color: #c678dd;">()</span> <span style="color: #c678dd;">{</span> <span style="color: #51afef;">return</span> value; <span style="color: #c678dd;">}</span>
<span style="color: #51afef;">}</span>;

<span style="color: #51afef;">typedef</span> <span style="color: #ECBE7B;">integral_constant</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">bool</span>, <span style="color: #a9a1e1;">true</span><span style="color: #51afef;">&gt;</span> <span style="color: #ECBE7B;">true_type</span>;
<span style="color: #51afef;">typedef</span> <span style="color: #ECBE7B;">integral_constant</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">bool</span>, <span style="color: #a9a1e1;">false</span><span style="color: #51afef;">&gt;</span> <span style="color: #ECBE7B;">false_type</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23450;&#20041;&#19968;&#20010; Person &#31867;</span>
<span style="color: #51afef;">class</span> <span style="color: #ECBE7B;">Person</span> <span style="color: #51afef;">{</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">string</span> <span style="color: #dcaeea;">name</span>; <span style="color: #51afef;">}</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#33258;&#23450;&#20041;&#19968;&#20010; type predicate</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">struct</span> <span style="color: #ECBE7B;">is_Person</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">static</span> <span style="color: #51afef;">constexpr</span> <span style="color: #ECBE7B;">bool</span> <span style="color: #dcaeea;">value</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">is_same</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Person</span>, <span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span>::value;
  <span style="color: #51afef;">typedef</span> <span style="color: #ECBE7B;">is_Person</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #ECBE7B;">type</span>;
<span style="color: #51afef;">}</span>;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">is_Person</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">Person</span><span style="color: #c678dd;">&gt;</span>::value &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<pre class="example">
1
</pre>
</div>
</div>
<div id="outline-container-org564998c" class="outline-2">
<h2 id="org564998c"><span class="section-number-2">23</span> 辅助函数</h2>
<div class="outline-text-2" id="text-23">
</div>
<div id="outline-container-orgff1e51f" class="outline-3">
<h3 id="orgff1e51f"><span class="section-number-3">23.1</span> <code>std::max</code></h3>
<div class="outline-text-3" id="text-23-1">
<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">algorithm</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22312; std::max(const T&amp;, const T&amp;) &#22806;&#38754;&#21152;&#20102;&#25171;&#21360;&#21253;&#35013;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">T</span>&amp; <span style="color: #c678dd;">max</span><span style="color: #51afef;">(</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">T</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">T</span>&amp; <span style="color: #dcaeea;">b</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Use std::max(const T&amp;, const T&amp;);"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">std</span>::max<span style="color: #c678dd;">(</span>a, b<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22312; std::max(std::initializer_list&lt;T&gt;) &#22806;&#38754;&#21152;&#20102;&#25171;&#21360;&#21253;&#35013;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">T</span> <span style="color: #c678dd;">max</span><span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">initializer_list</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">T</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">initList</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Use std::max(std::initializer_list&lt;T&gt;);"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">return</span> <span style="color: #a9a1e1;">std</span>::max<span style="color: #c678dd;">(</span>initList<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T1</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T2</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">auto</span> <span style="color: #c678dd;">max</span><span style="color: #51afef;">(</span><span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">T1</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #51afef;">const</span> <span style="color: #ECBE7B;">T2</span>&amp; <span style="color: #dcaeea;">b</span><span style="color: #51afef;">)</span> -&gt; <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">common_type_t</span><span style="color: #51afef;">&lt;</span><span style="color: #ECBE7B;">T1</span>, <span style="color: #ECBE7B;">T2</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Use max(const T1&amp; a, const T2&amp; b);"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">return</span> a &gt; b ? a : b;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23454;&#29616;&#19968;&#20010;&#21464;&#21442;&#30340; max &#20989;&#25968;&#27169;&#26495;&#65292;&#27880;&#24847;&#19982;&#21021;&#22987;&#21270;&#21442;&#25968;&#21015;&#30340;&#21306;&#21035;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">Arg</span>, <span style="color: #51afef;">typename</span><span style="color: #c678dd;">...</span> <span style="color: #ECBE7B;">Args</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">auto</span> <span style="color: #c678dd;">max</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">Arg</span> <span style="color: #dcaeea;">arg</span>, <span style="color: #ECBE7B;">Args</span><span style="color: #c678dd;">...</span> <span style="color: #dcaeea;">args</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Use auto max(Arg arg, Args... args);"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #51afef;">return</span> arg &gt; max<span style="color: #c678dd;">(</span>args<span style="color: #c678dd;">...</span><span style="color: #c678dd;">)</span> ? arg : max<span style="color: #c678dd;">(</span>args<span style="color: #c678dd;">...</span><span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; max<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;(</span>1, 2<span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; max<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;(</span><span style="color: #98be65;">{</span>1, 2, 3<span style="color: #98be65;">}</span><span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; max<span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span>, <span style="color: #ECBE7B;">float</span>, <span style="color: #ECBE7B;">double</span><span style="color: #c678dd;">&gt;(</span>1, 2.2, 3.14<span style="color: #c678dd;">)</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Use</td>
<td class="org-left">std::max(const</td>
<td class="org-left">T&amp;,</td>
<td class="org-left">const</td>
<td class="org-left">T&amp;);</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Use</td>
<td class="org-left">std::max(std::initializer<sub>list</sub>&lt;T&gt;);</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">3</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Use</td>
<td class="org-left">auto</td>
<td class="org-left">max(Arg</td>
<td class="org-left">arg,</td>
<td class="org-left">Args&#x2026;</td>
<td class="org-left">args);</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Use</td>
<td class="org-left">max(const</td>
<td class="org-left">T1&amp;</td>
<td class="org-left">a,</td>
<td class="org-left">const</td>
<td class="org-left">T2&amp;</td>
<td class="org-left">b);</td>
</tr>

<tr>
<td class="org-left">Use</td>
<td class="org-left">max(const</td>
<td class="org-left">T1&amp;</td>
<td class="org-left">a,</td>
<td class="org-left">const</td>
<td class="org-left">T2&amp;</td>
<td class="org-left">b);</td>
</tr>

<tr>
<td class="org-left">3.14</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc8cba45" class="outline-3">
<h3 id="orgc8cba45"><span class="section-number-3">23.2</span> <code>std::swap</code></h3>
<div class="outline-text-3" id="text-23-2">
<p>
标准库内有不同的 <code>std::swap</code> 重载版本，你也可以重载自己的版本
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">utility</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22312; std::swap(T&amp;, T&amp;b) &#22806;&#38754;&#21152;&#20102;&#25171;&#21360;&#21253;&#35013;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef;">inline</span> <span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">swap</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">T</span>&amp; <span style="color: #dcaeea;">a</span>, <span style="color: #ECBE7B;">T</span>&amp; <span style="color: #dcaeea;">b</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Use std::swap(T&amp;, T&amp;b);"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::swap<span style="color: #c678dd;">(</span>a, b<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#22312; std::swap(T (&amp;a)[N], T (&amp;b)[N]) &#22806;&#38754;&#21152;&#20102;&#25171;&#21360;&#21253;&#35013;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">T</span>, <span style="color: #ECBE7B;">size_t</span> <span style="color: #dcaeea;">N</span><span style="color: #51afef;">&gt;</span>
<span style="color: #ECBE7B;">void</span> <span style="color: #c678dd;">swap</span><span style="color: #51afef;">(</span><span style="color: #ECBE7B;">T</span> <span style="color: #c678dd;">(</span>&amp;<span style="color: #dcaeea;">a</span><span style="color: #c678dd;">)[</span>N<span style="color: #c678dd;">]</span>, <span style="color: #ECBE7B;">T</span> <span style="color: #c678dd;">(</span>&amp;<span style="color: #dcaeea;">b</span><span style="color: #c678dd;">)[</span>N<span style="color: #c678dd;">]</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"Use std::swap(T (&amp;a)[N], T (&amp;b)[N]);"</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #a9a1e1;">std</span>::swap<span style="color: #c678dd;">(</span>a, b<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">ia</span> = 1;
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">ib</span> = 2;
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">iarra</span><span style="color: #c678dd;">[</span>3<span style="color: #c678dd;">]</span> = <span style="color: #c678dd;">{</span>1, 2, 3<span style="color: #c678dd;">}</span>;
  <span style="color: #ECBE7B;">int</span> <span style="color: #dcaeea;">iarrb</span><span style="color: #c678dd;">[</span>3<span style="color: #c678dd;">]</span> = <span style="color: #c678dd;">{</span>4, 5, 6<span style="color: #c678dd;">}</span>;

  swap<span style="color: #c678dd;">(</span>ia, ib<span style="color: #c678dd;">)</span>;
  swap<span style="color: #c678dd;">(</span>iarra, iarrb<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Use std::swap(T&amp;</td>
<td class="org-left">T&amp;b);</td>
</tr>

<tr>
<td class="org-left">Use std::swap(T (&amp;a)[N]</td>
<td class="org-left">T (&amp;b)[N]);</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org721fce2" class="outline-3">
<h3 id="org721fce2"><span class="section-number-3">23.3</span> <code>ratio&lt;&gt;</code> 编译期分数运算</h3>
<div class="outline-text-3" id="text-23-3">
<p>
<code>std::ratio</code> 可以实现编译期约分
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">ratio</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#23450;&#20041;&#19968;&#20010;&#20998;&#25968;&#31867;&#22411;</span>
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">FiveThirds</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ratio</span><span style="color: #c678dd;">&lt;</span>5, 3<span style="color: #c678dd;">&gt;</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">FiveThirds</span>::num &lt;&lt; <span style="color: #98be65;">"/"</span> &lt;&lt; <span style="color: #a9a1e1;">FiveThirds</span>::den &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20998;&#25968;&#20250;&#22312;&#32534;&#35793;&#26399;&#32422;&#20998;</span>
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">Two</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ratio</span><span style="color: #c678dd;">&lt;</span>30, 15<span style="color: #c678dd;">&gt;</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">Two</span>::num &lt;&lt; <span style="color: #98be65;">"/"</span> &lt;&lt; <span style="color: #a9a1e1;">Two</span>::den &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20004;&#20998;&#25968;&#30456;&#21152;</span>
  <span style="color: #51afef;">using</span> <span style="color: #ECBE7B;">ElevenThirds</span> = <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ratio_add</span><span style="color: #c678dd;">&lt;</span>FiveThirds, Two<span style="color: #c678dd;">&gt;</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #a9a1e1;">ElevenThirds</span>::num &lt;&lt; <span style="color: #98be65;">"/"</span> &lt;&lt; <span style="color: #a9a1e1;">ElevenThirds</span>::den &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#20351;&#29992;&#39044;&#23450;&#20041;&#30340; ratio &#21333;&#20301;</span>
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; <span style="color: #98be65;">"1 TB = "</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">tera</span>::num &lt;&lt; <span style="color: #98be65;">" Bytes."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">5/3</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">2/1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">11/3</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">1</td>
<td class="org-left">TB</td>
<td class="org-left">=</td>
<td class="org-left">1000000000000</td>
<td class="org-left">Bytes.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orga8f3753" class="outline-3">
<h3 id="orga8f3753"><span class="section-number-3">23.4</span> <code>chrono</code></h3>
<div class="outline-text-3" id="text-23-4">
<p>
<code>chrono</code> 库中常用的 duration 表示
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">chrono</span><span style="color: #51afef;">&gt;</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">chrono &#20351;&#29992;&#19968;&#20010;&#25968;&#20540;&#21644;&#19968;&#20010; tick &#22823;&#23567;&#34920;&#31034;&#19968;&#20010; duration</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">chrono</span>::<span style="color: #ECBE7B;">duration</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">int</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">twentySeconds</span><span style="color: #c678dd;">(</span>20<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">chrono</span>::<span style="color: #ECBE7B;">duration</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">double</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ratio</span><span style="color: #98be65;">&lt;</span>60<span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">halfMinute</span><span style="color: #c678dd;">(</span>0.5<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">chrono</span>::<span style="color: #ECBE7B;">duration</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">long</span>, <span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ratio</span><span style="color: #98be65;">&lt;</span>1, 1000<span style="color: #98be65;">&gt;</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">oneMillisecond</span><span style="color: #c678dd;">(</span>1<span style="color: #c678dd;">)</span>;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#25110;&#32773;&#20351;&#29992; chrono &#24211;&#20013;&#23450;&#20041;&#30340;&#24120;&#29992;&#26102;&#38388;&#21333;&#20301;</span>
  <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">chrono</span>::<span style="color: #ECBE7B;">seconds</span> <span style="color: #dcaeea;">tenSeconds</span><span style="color: #c678dd;">(</span>10<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">chrono</span>::<span style="color: #ECBE7B;">hours</span> <span style="color: #dcaeea;">aDay</span><span style="color: #c678dd;">(</span>24<span style="color: #c678dd;">)</span>;
<span style="color: #51afef;">}</span>
</pre>
</div>
</div>

<div id="outline-container-org5ce6708" class="outline-4">
<h4 id="org5ce6708"><span class="section-number-4">23.4.1</span> Duration 的算数运算</h4>
<div class="outline-text-4" id="text-23-4-1">
<p>
此处时间段的算数计算与隐式转换规则
</p>
<ol class="org-ol">
<li>时间段可进行加减乘除与取模等算术运算</li>
<li>duration 可隐式转换为更精确的单位（tick 更小），但反之不行。这也就是为什么要
将 <code>remain</code> 变量定义为 <code>seconds</code> 类型的原因</li>
</ol>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">chrono</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">chrono</span>;

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#35745;&#31639;&#19968;&#22825;&#26377;&#22810;&#23569;&#31186;</span>
  <span style="color: #ECBE7B;">seconds</span> <span style="color: #dcaeea;">secondsInADay</span><span style="color: #c678dd;">(</span>hours<span style="color: #98be65;">(</span>24<span style="color: #98be65;">)</span><span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; secondsInADay.count<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #98be65;">" seconds in a day."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;

  <span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#35745;&#31639;&#19968;&#22825;&#36807;&#21435; 1 &#23567;&#26102; 15 &#20998;&#38047; 35 &#31186;&#21518;&#36824;&#21097;&#20313;&#22810;&#23569;&#26102;&#38388;</span>
  <span style="color: #ECBE7B;">hours</span> <span style="color: #dcaeea;">aDay</span><span style="color: #c678dd;">(</span>24<span style="color: #c678dd;">)</span>;
  <span style="color: #ECBE7B;">seconds</span> <span style="color: #dcaeea;">remain</span><span style="color: #c678dd;">(</span>aDay<span style="color: #c678dd;">)</span>;
  remain = remain - hours<span style="color: #c678dd;">(</span>1<span style="color: #c678dd;">)</span> - minutes<span style="color: #c678dd;">(</span>15<span style="color: #c678dd;">)</span> - seconds<span style="color: #c678dd;">(</span>35<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; remain.count<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #98be65;">" seconds remains."</span> &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-right">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-right">86400</td>
<td class="org-left">seconds</td>
<td class="org-left">in</td>
<td class="org-left">a</td>
<td class="org-left">day.</td>
</tr>

<tr>
<td class="org-right">81865</td>
<td class="org-left">seconds</td>
<td class="org-left">remains.</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org4077aaf" class="outline-4">
<h4 id="org4077aaf"><span class="section-number-4">23.4.2</span> Duration 的其它操作</h4>
<div class="outline-text-4" id="text-23-4-2">
<p>
上面代码块中的 <code>std::chrono::duration::count</code> 正是 Duration 的一个操作，用于返回一
个时间段对应 tick 单位的计数，可利用它实现打印一个 Duration
</p>

<div class="org-src-container">
<pre class="src src-C++"><span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">chrono</span><span style="color: #51afef;">&gt;</span>
<span style="color: #51afef; font-weight: bold;">#include</span> <span style="color: #51afef;">&lt;</span><span style="color: #98be65;">iostream</span><span style="color: #51afef;">&gt;</span>

<span style="color: #51afef;">using</span> <span style="color: #51afef;">namespace</span> <span style="color: #a9a1e1;">std</span>::<span style="color: #a9a1e1;">chrono</span>;

<span style="color: #5B6268;">// </span><span style="color: #5B6268;">&#37325;&#36733; std::chrono::duration &#30340; &lt;&lt; &#36816;&#31639;&#31526;</span>
<span style="color: #51afef;">template</span><span style="color: #51afef;">&lt;</span><span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">C</span>, <span style="color: #51afef;">typename</span> <span style="color: #ECBE7B;">R</span><span style="color: #51afef;">&gt;</span>
<span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #51afef;">operator</span><span style="color: #c678dd;">&lt;&lt;</span><span style="color: #51afef;">(</span><span style="color: #a9a1e1;">std</span>::<span style="color: #ECBE7B;">ostream</span>&amp; <span style="color: #dcaeea;">os</span>, <span style="color: #ECBE7B;">duration</span><span style="color: #c678dd;">&lt;</span><span style="color: #ECBE7B;">C</span>, <span style="color: #ECBE7B;">R</span><span style="color: #c678dd;">&gt;</span> <span style="color: #dcaeea;">d</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
  <span style="color: #51afef;">return</span> os &lt;&lt; <span style="color: #98be65;">"["</span> &lt;&lt; d.count<span style="color: #c678dd;">()</span> &lt;&lt; <span style="color: #98be65;">" of "</span> &lt;&lt; <span style="color: #a9a1e1;">R</span>::num &lt;&lt; <span style="color: #98be65;">"/"</span> &lt;&lt; <span style="color: #a9a1e1;">R</span>::den &lt;&lt; <span style="color: #98be65;">"]"</span>;
<span style="color: #51afef;">}</span>

<span style="color: #ECBE7B;">int</span> <span style="color: #c678dd;">main</span><span style="color: #51afef;">()</span>
<span style="color: #51afef;">{</span>
  <span style="color: #ECBE7B;">milliseconds</span> <span style="color: #dcaeea;">d</span><span style="color: #c678dd;">(</span>42<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; d &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
  <span style="color: #ECBE7B;">hours</span> <span style="color: #dcaeea;">day</span><span style="color: #c678dd;">(</span>24<span style="color: #c678dd;">)</span>;
  <span style="color: #a9a1e1;">std</span>::cout &lt;&lt; day &lt;&lt; <span style="color: #a9a1e1;">std</span>::endl;
<span style="color: #51afef;">}</span>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">[42</td>
<td class="org-left">of</td>
<td class="org-left">1/1000]</td>
</tr>

<tr>
<td class="org-left">[24</td>
<td class="org-left">of</td>
<td class="org-left">3600/1]</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<div id="author-info">
      <div id="author">Author: Cycoe (cycoejoo@163.com)</div>
      <div id="date">Date: <2020-06-10 Wed 10:34></div>
      <div id="generator">Generator: <a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.0.50 (<a href="https://orgmode.org">Org</a> mode 9.4.4)</div>
      <div id="built">Built: <2021-05-31 Mon 18:28></div>
      </div><div id="copyright">
    <img id="cc" src="/static/img/Cc-logo-128x128.png" height="14px" width="14px"/>本站文章如未特殊声明，默认采用<a href="http://creativecommons.org/licenses/by-nc-sa/2.5/cn/" target="_blank">署名-非商业性使用-相同方式共享 2.5 中国大陆</a>进行许可。
</div>
</div>
</body>
</html>
